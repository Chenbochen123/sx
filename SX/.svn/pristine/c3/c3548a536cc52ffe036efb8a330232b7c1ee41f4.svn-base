using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Mesnac.Entity;
using Ext.Net;
using Mesnac.Business.Implements;
using NBear.Common;
using System.Text.RegularExpressions;
using Mesnac.Data.Components;
using System.Data;
using System.IO;
using System.Text;
using Microsoft.Win32;
using System.Diagnostics;
using Ionic.Zip;
using NPOI.SS.UserModel;
using NPOI.HSSF.UserModel;
using System.Data.SqlClient;
public partial class Manager_BasicInfo_DepartmentInfo_Department : Mesnac.Web.UI.Page
{
    protected BasDeptManager manager = new BasDeptManager();//业务对象
    protected SysCodeManager sysCodeManager = new SysCodeManager();
    protected BasDeptErpInfoManager erpInfoManager = new BasDeptErpInfoManager();
    protected Ext.Net.MessageBox msg = new Ext.Net.MessageBox();//弹出框
    protected EntityArrayList<BasDept> entityList;
    private string topDepCode = "00000";

    #region 权限定义
    protected __ _ = new __();
    public class __ : ___  //必须继承___   //Action不能重复，重复会被覆盖
    {
        public __()
        {
            查询 = new SysPageAction() { ActionID = 1, ActionName = "btn_search" };
            历史查询 = new SysPageAction() { ActionID = 2, ActionName = "btn_history_search" };
            导出 = new SysPageAction() { ActionID = 3, ActionName = "btnExport" };
            修改 = new SysPageAction() { ActionID = 4, ActionName = "Edit" };
            删除 = new SysPageAction() { ActionID = 5, ActionName = "Delete" };
            恢复 = new SysPageAction() { ActionID = 6, ActionName = "Recover" };
            添加 = new SysPageAction() { ActionID = 7, ActionName = "btn_add" };
        }
        public SysPageAction 查询 { get; private set; } //必须为 public
        public SysPageAction 历史查询 { get; private set; } //必须为 public
        public SysPageAction 导出 { get; private set; } //必须为 public
        public SysPageAction 修改 { get; private set; } //必须为 public
        public SysPageAction 删除 { get; private set; } //必须为 public
        public SysPageAction 恢复 { get; private set; } //必须为 public
        public SysPageAction 添加 { get; private set; } //必须为 public
    }
    #endregion

    #region 初始化方法
    /// <summary>
    /// 页面初始化方法
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!X.IsAjaxRequest)
        {
            InitTreeDept();
        }
    }
    #region 查询显示左侧部门列表 树
    [DirectMethod]
    public string treePanelDeptLoad(string pageid)
    {
        WhereClip whereDept = new WhereClip();
        whereDept.And(BasDept._.DeleteFlag == "0");
        whereDept.And(BasDept._.ParentNum == pageid);
        EntityArrayList<BasDept> deptList = manager.GetListByWhere(whereDept);
        NodeCollection nodes = new Ext.Net.NodeCollection();
        if (deptList.Count > 0)
        {
            foreach (BasDept dept in deptList)
            {
                if (manager.GetListByWhere(BasDept._.ParentNum == dept.DepCode && BasDept._.DeleteFlag == 0).Count > 0)
                {
                    Node node = new Node();
                    node.NodeID = dept.DepCode;
                    node.Text = dept.DepName;
                    node.Icon = Icon.Building;
                    node.Leaf = false;
                    nodes.Add(node);
                }
                else
                {
                    Node node = new Node();
                    node.NodeID = dept.DepCode;
                    node.Text = dept.DepName;
                    node.Icon = Icon.BuildingGo;
                    node.Leaf = true;
                    nodes.Add(node);
                }
            }
        }
        return nodes.ToJson();
    }
    /// <summary>
    /// 初始化部门列表树
    /// </summary>
    private void InitTreeDept()
    {
        if (this._.查询.SeqIdx == 0)
        {
            return;
        }
        treeDept.GetRootNode().RemoveAll();
        WhereClip where = new WhereClip();
        where.And(BasDept._.DeleteFlag == "0");
        where.And(BasDept._.DepCode == "00001");
        EntityArrayList<BasDept> lst = manager.GetListByWhere(where);
        foreach (BasDept dept in lst)
        {

            Node node = new Node();
            node.NodeID = dept.DepCode;
            node.Text = dept.DepName;
            node.Icon = Icon.Building;
            treeDept.GetRootNode().AppendChild(node);
        }
    }
    #endregion
    #endregion

    #region 分页相关方法
    private PageResult<BasDept> GetPageResultData(PageResult<BasDept> pageParams)
    {
        BasDeptManager.QueryParams queryParams = new BasDeptManager.QueryParams();
        queryParams.pageParams = pageParams;
        queryParams.depCode = txt_dep_code.Text.TrimEnd().TrimStart();
        queryParams.depName = txt_dep_name.Text.TrimEnd().TrimStart();
        queryParams.parentNum = hidden_parent_num.Value == "" ? "" : hidden_parent_num.Value.ToString();
        queryParams.erpCode = txt_erp_code.Text.TrimEnd().TrimStart();
        queryParams.remark = txt_remark.Text.TrimEnd().TrimStart();
        queryParams.deleteFlag = hidden_delete_flag.Text;

        return manager.GetTablePageDataBySql(queryParams);
    }

    [DirectMethod]
    public object GridPanelBindData(string action, Dictionary<string, object> extraParams)
    {
        if (!Regex.IsMatch(txt_dep_code.Text.TrimEnd().TrimStart(), "^[0-9]*$"))
        {
            txt_dep_code.Text = "";
        }
        if (this._.查询.SeqIdx == 0)
        {
            return "";
        }
        StoreRequestParameters prms = new StoreRequestParameters(extraParams);
        PageResult<BasDept> pageParams = new PageResult<BasDept>();
        pageParams.PageIndex = prms.Page;
        pageParams.PageSize = prms.Limit;
        pageParams.Orderfld = "ObjID ASC";

        PageResult<BasDept> lst = GetPageResultData(pageParams);
        DataTable data = lst.DataSet.Tables[0];

        int total = lst.RecordCount;
        return new { data, total };
    }
    #endregion

    #region 打印
    /// <summary>
    /// 打印调用方法
    /// yuany 2013年3月2日
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void btnExportSubmit_Click(object sender, EventArgs e)
    {
        if (!Regex.IsMatch(txt_dep_code.Text.TrimEnd().TrimStart(), "^[0-9]*$"))
        {
            txt_dep_code.Text = "";
        }
        PageResult<BasDept> pageParams = new PageResult<BasDept>();
        pageParams.PageSize = -100;
        PageResult<BasDept> lst = GetPageResultData(pageParams);
        for (int i = 0; i < lst.DataSet.Tables[0].Columns.Count; i++)
        {
            bool isshow = false;
            DataColumn dc = lst.DataSet.Tables[0].Columns[i];
            foreach (ColumnBase cb in this.pnlList.ColumnModel.Columns)
            {
                if ((cb.DataIndex != null) && (cb.DataIndex.ToUpper() == dc.ColumnName.ToUpper()))
                {
                    dc.ColumnName = cb.Text;
                    isshow = true;
                    break;
                }
            }
            if (!isshow)
            {
                lst.DataSet.Tables[0].Columns.Remove(dc.ColumnName);
                i--;
            }
        }
        new Mesnac.Util.Excel.ExcelDownload().ExcelFileDown(lst.DataSet, "部门信息");
    }
    #endregion

    #region 增删改查按钮事件

    /// <summary>
    /// 点击添加按钮激发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
 
  protected void tohf()
  {
      BasMaterialManager manager = new BasMaterialManager();
      String sql = "select * from pptplan where recipeequipcode = '01038' and plandate >='2017-11-15' and tbflag is null and planstate>2 order by plandate";
      //and tbflag is null
      DataSet ds = manager.GetBySql(sql).ToDataSet();
      if (ds.Tables[0].Rows.Count == 0)
      {
          //msg.Alert("操作", "无计划！");
          //msg.Show(); 
          return;
      }
      DataRow dr = ds.Tables[0].Rows[0];
      string planid = dr["PlanID"].ToString();
      string RecipeMaterialCode = dr["RecipeMaterialCode"].ToString();
      string RecipeMaterialName = dr["RecipeMaterialName"].ToString();
      string RecipeVerSionID = dr["RecipeVerSionID"].ToString();
      string PlanNum = dr["PlanNum"].ToString();
      string RecipeType = dr["RecipeType"].ToString();
      try
      {
          sql = "update pptplan set tbflag ='1' where planid ='" + planid + "' ";
          ds = manager.GetBySql(sql).ToDataSet();

          sql = "   select * from pmtrecipe where recipeequipcode = '01038' and recipematerialcode = '" + RecipeMaterialCode + "' and recipeversionid = '" + RecipeVerSionID + "' and RecipeType = '" + RecipeType + "'";
          ds = manager.GetBySql(sql).ToDataSet(); dr = ds.Tables[0].Rows[0];
          String Recipeobjid = dr["ObjID"].ToString();
          String HFFlag = dr["HFFlag"].ToString();
          sql = " select * from PmtTypeToHF where  code = '" + RecipeType + "'";
          DataSet dst = manager.GetBySql(sql).ToDataSet();
          String RecipeTypeName = dst.Tables[0].Rows[0]["Name"].ToString();
          String HFRcode = RecipeMaterialName + "(" + dst.Tables[0].Rows[0]["HFCode"].ToString().Trim() + ")";


          HF.Service ws = new HF.Service();//  插入配方 删除称量信息 插入物料 插入称量信息 更新配方 插入计划
          ws.Url = "http://192.168.1.137:8018/MesToHf/Service.asmx";
          DataSet hfrecipe = ws.GetData("SELECT * FROM OPENQUERY(HFDB, 'select * from recipes_import where reci_recp_code = ''" + HFRcode + "'' and RECI_RECP_VERSION = " + RecipeVerSionID + "')");
          if (hfrecipe.Tables[0].Rows.Count == 0)
          {
              sql = ("insert into openquery(HFDB,'select RECI_LINE_NAME, RECI_RECP_CODE,RECI_RECP_NAME, RECI_RECP_VERSION, RECI_BLOCKED, RECI_FUNCTION, RECI_HOST_ID ,RECI_RECP_CODE_2 from recipes_import where 1=0') values ('Line01','" + HFRcode + "','" + RecipeMaterialName + RecipeTypeName + "'," + RecipeVerSionID + ", 1, 9, 1,'" + RecipeMaterialCode + "');   ");

              ws.GetData("insert into openquery(HFDB,'select RECI_LINE_NAME, RECI_RECP_CODE,RECI_RECP_NAME, RECI_RECP_VERSION, RECI_BLOCKED, RECI_FUNCTION, RECI_HOST_ID ,RECI_RECP_CODE_2 from recipes_import where 1=0') values ('Line01','" + HFRcode + "','" + RecipeMaterialName + RecipeTypeName + "'," + RecipeVerSionID + ", 1, 9, 1,'" + RecipeMaterialCode + "');   ");
              HFFlag = "";
          }

          hfrecipe = ws.GetData("SELECT * FROM OPENQUERY(HFDB, 'select * from recipes_import where reci_recp_code = ''" + HFRcode + "'' and RECI_RECP_VERSION = " + RecipeVerSionID + " ')");
          String hfreid = hfrecipe.Tables[0].Rows[0]["RECI_ID"].ToString();
       

          if (string.IsNullOrEmpty(HFFlag.Trim()))
          {
              sql = (" delete from OPENQUERY(HFDB, 'select * from recipes_cmp_import where rcmp_reci_id = " + hfreid + "');   ");
              ws.GetData(" delete from OPENQUERY(HFDB, 'select * from recipes_cmp_import where rcmp_reci_id = " + hfreid + "');   ");


              sql = "select * from pmtrecipeweight where recipeobjid = '" + Recipeobjid + "'";
              ds = manager.GetBySql(sql).ToDataSet();
       
              foreach (DataRow drow in ds.Tables[0].Rows)
              {
                  sql = "select * from basmaterial where materialcode  = '" + drow["MaterialCode"].ToString() + "'";
                  DataSet dm = manager.GetBySql(sql).ToDataSet();
                  if (dm.Tables[0].Rows.Count == 0)
                  {

                      continue;
                  }
                  String hfcode = dm.Tables[0].Rows[0]["HFCode"].ToString();
                  if (string.IsNullOrEmpty(hfcode)) hfcode = dm.Tables[0].Rows[0]["ERPCode"].ToString();
                  if (string.IsNullOrEmpty(hfcode)) hfcode = "0";
                  string mtype = "Mes";
                  if (drow["MaterialCode"].ToString().Substring(0, 3) == "104") mtype = "Carbon";
                  if (drow["MaterialCode"].ToString().Substring(0, 1) == "2") mtype = "Chemical";
                  if (drow["MaterialCode"].ToString().Substring(0, 3) == "107") mtype = "Oil";
                  if (drow["MaterialCode"].ToString().Substring(0, 3) == "101") mtype = "Rubber";
                  if (drow["MaterialCode"].ToString().Substring(0, 3) == "102") mtype = "Rubber";
                  if (drow["MaterialCode"].ToString().Substring(0, 3) == "103") mtype = "Rubber";

                  dm = ws.GetData("SELECT * FROM OPENQUERY(HFDB, 'select * from materials_import where MATI_NAME =''" + drow["MaterialCode"].ToString() + "'' ')");
                  if (dm.Tables[0].Rows.Count == 0)
                  {
                      sql = (@"insert into openquery(HFDB,'select MATI_MAT_GROUP,MATI_MAT_CODE,MATI_NAME,MATI_MAT_TYPE,MATI_FUNCTION from materials_import where 1=0') values ('" + mtype + "','" + hfcode + "','" + drow["MaterialCode"].ToString() + "','RAW',9);  ");
                      ws.GetData(@"insert into openquery(HFDB,'select MATI_MAT_GROUP,MATI_MAT_CODE,MATI_NAME,MATI_MAT_TYPE,MATI_FUNCTION from materials_import where 1=0') values ('" + mtype + "','" + hfcode + "','" + drow["MaterialCode"].ToString() + "','RAW',9);  ");
                  }
                  else
                  {
                      sql = (@" delete from OPENQUERY(HFDB, 'select * from materials_import  where MATI_NAME =''" + drow["MaterialCode"].ToString() + "'' ');    ");
                      ws.GetData(@" delete from OPENQUERY(HFDB, 'select * from materials_import  where MATI_NAME =''" + drow["MaterialCode"].ToString() + "'' ');    ");
                      sql = (@"insert into openquery(HFDB,'select MATI_MAT_GROUP,MATI_MAT_CODE,MATI_NAME,MATI_MAT_TYPE,MATI_FUNCTION from materials_import where 1=0') values ('" + mtype + "','" + hfcode + "','" + drow["MaterialCode"].ToString() + "','RAW',4);  ");
                      ws.GetData(@"insert into openquery(HFDB,'select MATI_MAT_GROUP,MATI_MAT_CODE,MATI_NAME,MATI_MAT_TYPE,MATI_FUNCTION from materials_import where 1=0') values ('" + mtype + "','" + hfcode + "','" + drow["MaterialCode"].ToString() + "','RAW',4);  ");

                      //ws.GetData(@"   update OPENQUERY(HFDB, 'select * from materials_import where MATI_NAME=" + drow["MaterialCode"].ToString() + "') set MATI_FUNCTION=4  ,MATI_MAT_CODE  = '" + hfcode + "'");

                  }
                  sql = (@"insert into openquery(HFDB,'select RCMP_RECI_ID,RCMP_MAT_CODE,RCMP_WEIGHT from recipes_cmp_import where 1=0') 
values (" + hfreid + ",'" + hfcode + "'," + drow["SetWeight"].ToString() + ");  ");
                  ws.GetData(@"insert into openquery(HFDB,'select RCMP_RECI_ID,RCMP_MAT_CODE,RCMP_WEIGHT from recipes_cmp_import where 1=0') 
values (" + hfreid + ",'" + hfcode + "'," + drow["SetWeight"].ToString() + ");  ");


              }

              sql = ("   update OPENQUERY(HFDB, 'select * from recipes_import where RECI_ID= " + hfreid + "') set RECI_FUNCTION=4  ");
              ws.GetData(sql);

          
              sql = "update pmtrecipe set hfflag ='2' where objid ='" + Recipeobjid + "' ";
              ds = manager.GetBySql(sql).ToDataSet();



          }
          sql = (@" delete from OPENQUERY(HFDB, 'select * from prod_orders_imp  where pori_order_number =''" + planid + "'' ');    ");
          ws.GetData(sql);
          sql = (@"  insert into openquery(HFDB,'select pori_line_name, pori_order_number, pori_recipe_code, pori_recipe_version, 
                                              pori_batch_quantity_set, pori_order_weight, pori_pror_blocked, pori_function, 
                                              pori_host_id from prod_orders_imp where 1=0') 
values ('Line01','" + planid + "','" + HFRcode + "'," + RecipeVerSionID + "," + PlanNum + ", 0, 0, 9, 1);  ");
          ws.GetData(sql);

          sql = "update pptplan set tbflag ='2' where planid ='" + planid + "' ";
          ds = manager.GetBySql(sql).ToDataSet();


          //msg.Alert("操作", "导入HF成功！");
          //msg.Show();
      }

      catch (Exception ex)
      {

          sql = sql.Replace("'", "''");// ex.Message.ToString() 

          string Esql = @"insert into SysWebLog (remark,methodresult,recordtime,UserCode,MethodID)
values('HF','失败 " + sql + planid + "',getdate(),'000001','1')";
          manager.GetBySql(Esql).ToDataSet();



      }

  }
  protected void toFile()
  {
      FileStream fs = new FileStream("d://HFMIX.zip", FileMode.CreateNew);

      HF.Service ws = new HF.Service();
      ws.Url = "http://192.168.1.137:8018/MesToHf/Service.asmx";


      String sql = "SELECT * FROM OPENQUERY(HFDB, 'select * from Batch_Report where batr_id = ''271079''')";
      DataSet ds =  ws.GetData(sql);
 
    
      byte[] brs = null;
      brs = (byte[])ds.Tables[0].Rows[0]["BATR_MEASURED_DATA"];      

      MemoryStream ms = new MemoryStream(brs);
      ms.WriteTo(fs);
      fs.Flush();
      ms.Close();
      fs.Close();
      //string str = @"504B0304140008080800DC753B4C0000000000000000000000000A0000003438393535372E525054E4BD5DAFA4496E2676BF80FF43DDF8725311647CEA5CD933C6DA86D6102419BA180F849ED9B2D4D0CCF4A0BBC72BFDFBE54332E2FDC8CC936F75571C6C7B85DD9E3A75B298C127180C92C18FBFFFE6C74F21DEA8DE28C4F616D35F73FB6B8E6F7FF3ED9F3E87F886BFFC8F21FE47AA9F22FF3585BF4EF4F6ABFFFD1F62296F91F82D05F9176FDFFDF93FFCD33F7CFBC7CFFFF4E9373FFCF6ED9FFEF3B7FFF6ED9FFE79FB8BBFFBE68F9FFEF6FBCF3FFCF097EF3F7FFACDFFF557BFFFE3FFF397107E47F29BEF7EFCE6C76FBFFBD30F9F7E13FFEA8FDFFEE9B76FBFFECB0F3FFEF0F99B3F08814F7FFB973FFEF9D36FFE6723F0AB3F7CFEE64FF8DBDF84BF8ABF7DFB3FF0777FF3CDBFFFEE9BDFFFEBA7DFFCF18FBF7DC3F7C9D77DFEBDFCF1F31FFFFCF9FB6F7ED4EFD3EF0ABFFAEDDB0F7FFEFCFBDBA7FFED4F9FBFFFE77FFFF49B7FFD3FFFEA5FFF59487FFEFFBEFBC35F7C0DB7DBCDBEECD7DFFEF0E3377FFAFD67A7FCDD8FB74FF71FD4BF365E3FEDBEFC6FBEFBAF9FBFC7DFCB7FFFEEF337FFE5DF7DC5FFF8F9DB7FFE177CF6FBDD5FFEFABBFFFAA71F7E94BFF9E3F1AF7728FCEABB3FFDF8FD777FF8FC5F3EFDEEDF85E0EFBFFDF367FFD43FFCEAFFFEF4AB7FF9E68FBF936FDAD8C4DF0AAEDF9DFFEED7DF7FF7E74FBFFEEEF0F7FFE9FBEF7EF8E1D3DFEA8A7FF3AFFFF8DBB75FFDE5FBEF3FFFE9C74FBFF95F7EFBF6BF7EF3E3EFFFE5D3632CEF37EEF9260B4EDFFCE1D343F4ED578FF7E06FBFFBE15BFC9DEFC16E197B74FEF1EF3FFD9DE0FAE39ED9E71FFD9BCFFFEFD34F7EDE3EF9EBEB447FFD2ED1BFFFC3B77FFEFEC232F79FBB42EED717C9BDBFBAFFF4F99BEF7FF7DDBF7D8A2F7E4F2F7ECF2F7E9F5EFC3EBFF87D79F1FBFAE2F76DF7FBFFFCED0F2258F2B17FFBF1ED7FFA0F54E85628BF855BD0FFDF6FFDAD8D1F227E1BDE12FE98E2ADBD9D7E51EBADC6D6FA1B711CBFF1FFC5FFCFA251DF7296FF9470632593729CC462D87D764755BFBEA5F9A70652C5E8C97FF08B4CE33F49A9EA9F18FF89F347FD1759FE53F25B144EC32DD78D833CC8FB17475F7B4C411038FDE2B0C82383BC6350BF9BEBA492EFF98B0BF8ABACFCC96F0EFCC5037FF38FB2B2FCF6E01757F80BBAA032C9E45B3A3318D63048CA60FEFF378374D841594C7C2CA2DC6FF5278A28E9B7EB3241A6CB79FF580EF75B18595674DEC3C121FDC43DE423875176F2FE186E2CE6AFCD221F37319DF429FE87E6DA7E228BBA84DC954C932F887927F21FC1E261179BACEB318BED279FC4A42751D70A3209DFD23F90C574D8450A0F940DFBDAF8A7B258F58BA39381A3B1BB613F82C5FD2E121F2F44952E63B11EB48DFEE2228B997767116428ED84FEEE4AFCEA2CE6E32EE607829A7C6DE927EE628EBBB3087B47BEE52305351F77B13DD0A883C5F01359AC4DBFD8CE6211EEE863CF6239EC228707BB987D6D3F55DD143B8BB68B598E21C70FBD34CA6117998E97864A97B1C80716BFE42C46E3B1DB368AD18F6BE423F54D3D6E6392159CB7D1D6168FD6CD97D86FDC95C7A67460828B4CA40FE5F1B08FF5C13E2A8F8713F47A1FD3DE82EB51D7C54E87ED6B8E3C2AC1453CB6C33ECA459DEEF651153ED52FDAC774B0E174AD294C3AB2B1E503F7B11DF6313DBA1B8DC77CB8FEBF6C1F755DFAAD51EEC526B7C8CEE85DBF8FFDB88FE5E410EB57E91FF9E8107FC13E52D415863EE9E8D77CDC3EF6E33EB6A3AC1ABAFA47FA19FBA82BA4E4741A56913F701FE1B4EEFDE293ADAA5F6D1B10EFD77491C9A82AD5ED7152CF38DC29D6C54C1E765236F6319371AF28BE7027AB2EA246A743F89A8F3474623CEFE43D93FA47518FFAB15C9A2C28E767CC8677AECAA6E6406E4E2F81D9F1DD31D616438C79F1CEB2318D9D8D1BD3F438AE13CD82CDF2E992CB336DF4DF35CB251BCB16E879C6B23913BA48D3968D6B4CA9DF89C10596B928CB34A9E997D9A75BAB2185B692E11607C3D863DA4E6F7FC230561E6FB16696FBF122C3074555758FAB6A630DBECC3D8E37CA31E71E3F82618B02D17B424DBEC4242B4B9539F67C166ABAC070B0F544A7C69B6696831553EB3D7D0CC3D861DE76B83D6198C59A8BB7220A36F6F25318CE66AEA4496DB7C34636ADD4D583618B10F1B6C3E1718448961865658D04FFD8CE0CF305866D29293A35B62F33862B152A297FC40E5BBC283D39C33B86614B09894EAD50FA290C7B087750CB1BC3836CFC881DB6E8517AEF0C9B1046C4446E9CB852E333C3E995962E6F6A41FAB343C4CB98DA70C62F974CDBADB4985F6C707E4F490F7E495696F5264E67257D815FB27796D29C5AC4975567B870CD257CC811B6C0D28EE1FA38B0A44BA45BE526FFEF4E49E75F12C3D8E1F2C453D8318CDFF08D3817BAC86EDAB11B53D6AF27A715368116F525EA2AB60F61D7224E65DB5F7A1C710AF019F85602B6A29E192EAF191695A4EE65766A6A591667B816EA9DCBC7308CFDAD1BC3E909C3F01FD24DEE4A2AED27F18B6FCD1AA501B1BCC9B358208938C50FD9600B45D5CDBDCF8F4351A199E0E6D643BA333AEA6B86B35E49B9D1A496C6DB9693E5FA310C6383DB58647C167B0B08D3971BE1B6BC97E80B0C9346523D72A3D47274C76190FD087E2D46D5DEB32A9BAFB0C8C2B88670AFB1DA6B76535081B6F88610A3ED008BCEEC6285D4F431FC627FFBA6A0F909BF8817CA9F72A416BF845F367E5943AB998C185229A686AEB752638E1F61529245AE76ECA6C7419D0033BF8982268AF56C70F4D7EC467D644C851D3BFDAEE26029D58F9066B218560CEFE967E31746AFFCA9F7DAEFC4F902BFAC4E618EE4C4C80266F6AFC55FA8F411D24C16CE8AEFC6B3A2A5BA4093F55B24B10DEEE31CE1C20EDB0DEC3B0C6AD30D76B2E56338D61D8EEF3949CA4E872A93DF8A379BEE0EF01586A9DB155C8CD82E96857F9D39F40F61D82359F1DDC84EB435462C4D2C8396F83EA27941A8F58B334D6A333AEB64B97E84CEB25056A4273A7AC7317C00F886B5F719AFFC328EC996EAD4C22EB4438891D5FC216ACB62597117BD7B90B585DF763CB6C2612FADF43BBB32D26B8E53C33A0A5C6F508BDB358C300A11E50FD9630B66C55D34ABDCEFB1729C10CD124B3AC8457C77335DE238E8526B18D4F22E754CC9D247706CD1ACC9718E0F1E91F4B71D1908D89FD6A8B63B8EF982E68A71263E2935FD32FDD74E367D0CC7BAC7BBF0CEBD6D691C93461D6F45BCC374E7FD5FE1D81268D4E4EA1EDEC983E12EC738D0471C630B67C5F4C498B62D4EB64651D5F2EF4536F37D103E5DB88D539FCF85422DEF2E2727FB113B6CF1AC98DF7D66D11457DC9FB2B2220BEBE92AC3BC6798C34C20526AF39905644B08F4211C5B40EB05C7D9D6A84BC31DD2EF0DAEFC9A63A5904C60FB3EC203AAB535E68F6158B7B83C89C21F185699EE1C624D3F85E1A82F0E738BF7E687912D1FF1924616D3DA73FC608BCBE4B88A9DD043BDBF9ACA15A1D675D4077B2C6459369F3E86E3F31EC7A71CEBD2B8CBDAFA9773DCF55578781183E33038A652F9434EB145B5627D57A8EB8EE11C8829DE315C2F301C36456D277A0AB590E5D2F86318CE7B861F7B4D7B864B0A7C6F5F5EE197F3CC65BDE3B78AD87C08BFFDB8C10FC35A2A89E30CB79098FA1DC3ED02C3A9EC253AEE241ADE79ECA52FB63D9271AC3BDCF7063597B9923C9CA1669FA0941227EEE75F5FE198589755DB6E8BEBE098339511EB8931AFE03828C76CA1ADD8F77A7A72DCED2568633815B932A3FB4CF65B5D63BFB0C396647FD05934F8CDA9340F78F7404BD9D5048F4312DA64B7EA3FDFB12B0651EDAE5BEC9797B975432BDEDF49F1567AEAEE85C91F17726B81AD3DB7BC719B66B243B3129FDE724CA9EE7EE93525AF65D9D6D47967730CE9BD35CACDFD916CD2BE8CDBC3DEAABA9ADC5AFA234DE58C442A72E56CBFBBCA6CD42D4B2DED986D33DA11445519B3CC2B05D9025A14F78FC21BB39A43CF1BB33573926DD8FD52FF145F73CBF68496C3E926CA4C995B406F811B521D066D5ECA733EF19C773CAB7E99124837EABD8F9C43FBE57B3C6F05C093E74EBB1DAE33BAD303777F13CF2B0FAFA766596C66C2ADC1F88D69337DC73AE59F94923D50BBD53A13BDC3B3EFB3C5B22A6D164783697D6B3114EA19DE2562B5EE7612F5A59CE7C1B97C6DA18AC7508D296E8C9B053C3748AEE256C7C9A379FF5EE1DC9E1F5C11BBE951A0B8AA4875D2904AEAA9914B785C29E116DED29A0991F6C6BDA56681CCCD0AB180FA5CEC2D6551DC2352D1F3BE4EEE859CD760F9AD7127E71A0A1651137903E74D2E7917F6D096329E27E31DF9804C0995877DC7780B1BE378FF13AD93793CE0B7F0058C8BDDECA9BA6927EE1AE1AB5409F65B0B59FE9FD35EB9E516EED2B47CF95762415360CB0139713E4FA6ACB451AD778CA7D78C8B4AB4A7453A4407B62F465A3A853EA2E29AA5BA8EF33C39E75B0D8CFE0EB231BB8B2CD6B2711EDFE4A2ED3D8E97E45ABE84734FD3AB79C779C4FA4A05BB722F70486DF0BD52B15BF40B714EC87ACC9D2DD2BA715DB2673F347FA5D197EEB2FBA5D789BE64BB8DA7F3293D90F1F9BDA21FC534183E6AA94BB9CE83EB8464B296F3C9DB884A7C635B7E6A35B5B2FBE555B663203BE0A11FDC8DF9CD2232E254C6F1A6B9F422B7501839A52C5676ACF698B0DBF1E209112300184A6CE34DBD6C76DD05D653B4425A6E076B7CFB6AAA62A68638321496EEBA05C58CF724EE63900BC574CEEE8CA713EFBD881F1277BFBCCC7BF0539EB6FB1149AFC24996FF4B454B824B8F953F40BF597C8CFC4194438D6654ED767D648E98C0B75B14EF7A8413CA7033E949C028EE398FD1347B6F07FD266B6E85C5762128F63ED2606B58CA771E7CCB27441EE53AB778CE8EF370E05CECEB26F6EAEE772F199FA150F2A291B8BBCAD5684AE2B57041893489B21B0F264B3D148B98A9CEC5F613139DA53DD59139A18BC5BDD38846B65FAA5B85FC854DF7FA913C6F483599503F285B2D3E198CC82A6E838B7B6A4B79CF8377397E1CA2587072FAF6F29EFA9177711D83D89765F7DBABBCF7E239706577D22356994B44EC4CBC889EB28B545A18424B164223BF5C13DC8633E3AE9626E3E24C51E9E3C97C734EFB6B816F96B451EAEE624B581F17B849625521157FE4696FE5B24B18CF937131243AE1493CB583B89F3917A32FB434629B5FC4790F964453D36ECBB5B3450FA946F59144ECA74BB0F2524F165AE39184D053D17B6DAFE3AC9A6D5ADAD066A1714EBBDF7AA388D75A2EB0E76CEF436CBBAF86B649250FA72087A5ACE7C9BAD853A2B3CAF9623BB0AEBB2B56491816C797B16EB10651729BE58E9AC8EDAB45FE33D1C85C5FCABA45DDD83F41A905B284E39D8ECB23DBA2C18993C57791D848BBDF2AEBF1CAAE93E70986E3A52E5A26D452AB1EFB14FB288E5CA9DF9345DF8C77F94FC8E2A39FE28E5602B6312F1F4E9DEBBC7EF805F361AFE792252ED5414CC332BB6F96F5709C3A34AD3CEC168AD3782E9E844A133BD33AEA9CF73D4DD6E56EEBF3316CDB767ACD79B7D67C613CAD91B987B27C04E84917CE6254F10708BC974BEA3F953FB39869D584F009E7111D5342CB89CA4F603D8666B5479477BC0BD622663920E691908AD48726490BEDF7E49593ACB160B8E0544F0F4676C56C891B7072794421378F95F97151FF81F3C8EEA9EFE39069FB669CED4DDC97DE6D168CF3EE6DF01AA99C5E53DC8ADD33DE9B985D2723F612E3411F42E57F4E571BE189A65256751FFAC8F0CA2B4D390BC6D9CB6CBE955CA8E453C8DDCEDB48E420DCBCE2D372AABBDF7AE3A097BC775D411FAE8BA7BF274B2F240D03E63A615D7AD02D18679C4FF721C74358CAA47DF335E42F3B5E96CEE27E81F3AA7BDC29EE4C3902E7E2A9119B5DD3686F2AAD62DCA2719C3D3426DF1AEEE271566F336F22040D03A5A980C7E7385F605CD3B32C1AB9BD36A8611144C361F9BD4F4C535FCA799E9CE388C552CB39E5E1C0B9BA57415CE9522F71AEE5589BB0772FF3083B6937F309596909174C153598F90376DD6272EC944A8F28013F3E283AEFF31216EAA986326CAD8DF7F29AF7A615793DEC75BBE6D7A6D4A39A7C2DC995993F40B95B44CEFB6D888B1C502277DA75D3EE1BE77864AAE3D573A7DE2F70DEDD8CDBAB387D5F96EFED22E6F2F196DB281058AAE22C1EA7C615DE1BB8473E6FB9D5B6F7B9D6728B4D9474DEFDD61BA6BD665C17DAEB8971BE097E0C565AAB3C1A2D2C3DE7168F33BEDB8D9B9CDF3B05178E7C8B90243C029EEFB4277CB7BDA807E3F8987F2A7745EDA2320B0C1A822FE88CAF3CE4168D632F83ED44A9D73BB3BD8CB48FB14985FB5041DB86B70B8C6B3A546F7BCBB5EDBE18B9AAB5D6A9DADB52CEF3E01C0B4CA25DEECC76A549617F0F511B4F419B8B7E81F3AE367EAF7987A2D5B1D79AE53617FBA69492DB7A9B3D5B2C8E870199991E9F719AC7326B478C695E6E5BDEAF6CB9550ED4B35A179D211EE99BDCF5516E96B63E16972D16677D2571B9152EE76491A8FF7E677209750AA3C82DC52F60BCABB1DECBFE19B96824AEC2607D2B726344EAD3075C78A1658BC4592366D1AA143B9DB75C8598E662F1ADBDD661BF4D114FE10AE7561679CC0DC2EAE59415EDD09ADABCCF122F655C1BDD44DFF290B99C9FCF5561EF18AFB758388C8B7CAAF32B8C37BD1E7AC8475F2541D649A014ED271A9087CDCE2B85DDC2708373314D52A0F39566C77C86A2E4DA29E2A69D157B8A1738D754BF9EF697847688ACB93439E5D53294D3FAA7864CBB2DEF3061422E0FFDD38D7161A18AC541A7ABFC0AE35D23EDBDECB73CEDBEB8220ED9B9AEB7DDB245E092FFD31C1AE57C4E8CD28B8566044E9453EAB33BDB345A135D605C35FAF4CBDD4983B9DE44B1BF55BE75B496F880FBCCE26FC6B738090DA5F667BE7338F29DC4A1EAB59C37FC09DFF520E9168FE083CD2A964AAC452EF937B9E1E54A9F92BE52AB5BF02D790C0AD74ABF8B41B5910D627CEBC70EA1F0D914F705DFB55B0165D8996EBBEFADF2E9C8341ECF976EB8772FF3A4A8147B09D9C4EFF48CBA635CAE9CB89957FD4B18B7B7B4168F41F6F9C5B589E7970E0FB4AB18F72E66C91B4E888249777CB79107D2209772E3945A461F866DC3D3EB035EED68D73A68597690AC91BAD84ECA1AC5C9372FE55B373C7B8D0075F1861FBE2DD00C3956A8F498D329C07E8971DBC316768C575CA225A5241B2E922007BCD27AEF2C5BE0CD189F4F1B8F4CF51977ABD647B09EEFF0FC0EDF7470CE38ED043DE17B29D5D6DE9AB8E5DC327DC0156E51372B774A37AE0D759EA7F88BD9AB53382BA139D778D2DFCCD55F14DF16714BDEDBD5E35E476BD5C47C869D443745F1B0EAF9212995D77C77B6460F7B8DAE71B6DEE48E6030285E799B69376529E7BAE31E77829B70F76C1A8E8C975BA7ADCF6A0A2F18AFFB0DB7B7E2520E1B3EBEB755B4F10B7D477815D7166D4B1EFDCEBDF45AEF1CD23C523F4CCE2B928F67CBAE6DC3EB6BBEBBDE877DF83AEC1BCE284EE16C75E014F207BC1B668BB7250F3B41B1F574AABDB22B8566C00D0BE030B28FE7CD7D85F1AA29FF7D7B7457C68504859261CAC2FC1F55B7BC926F0BB7251B897013D8B9DD6BF438D23E749370DD88DF1A4F2188D42E08BABAE03D4F73C0B25CE717CBAFC52B1C0931292E655C37BC1B395CE11659BE0BA9B3B7D60850BC35969ACECEC913C6CB9EF1AA8E389741CB622F62C084800D974B65EBE3B8D2462F166CB3609F1CB4584A3A673BAAC069BA47477B2F2CA2A436EAD379575ABCF11D9FF05DEC127362D59428A28C22E8A44D7D70A9ADDFEF12B6FDC61A6ACAE7F22497F3D93AA6A1E75F4EED2CE757D8B6BA1BE5A0F3480B98DFDB91CC5DC7EBF34A83AD58A02DBB6242317F7FC2F76C3924F78DDCC1E57CBE73B8C0B7E703A8FD924799255E8889C50A446BAD42795CE02B155BB1405BF6B3261769E6B33ED7A029CFE652A290C45F1E6634F72FE1DB5AA505A7551CF0A2D910BD69D7B812CB08E8F0429BAD589CCD18D70684FD89AD6AE16064AFA18D4E816D77B45573FCA571AE5B4E460EEF2777CFC34AC31847ED58471FE219FE4CFC258CDB15AE0CF5662F0804DBA508DB493B41F6DC6B5F6FA5178BB3D9BFCA7817AFF59CBA6F1B9EACBB5DC639CFB197BB0DA70B7C5BE7CC10072D15AD2DFD041D4E639B0146EE4B19DF367CD44C3CB45D2C5929B856CA71BAA3F14B38B750531BC446E0A5DE44825A63655D7CB7D11087173D1666B06EA1366BCFB08BBCEC935AF54FD17B56562DAECE3C7B7ECECF65BEC2BA1E19EFA749A3D5075EE42BFA9A685FEA9A46E76D0E4B39D74DF77F2F0E21B2884F5146E6C93AE1AA13CF3994D9A96866B85D62DD8DF4E0BD623DB951763D9582C2283421AFA587D1DDA52FE4DDE26DF6EF13AA74B8F2D92FE5390E23E8C48E5B66CEB32FD5CCDECEE931EFF9DE6AA51DB56097BA996F18A05033B5D971BD2DE55DF7DD636E62C8A0D3DB69DF35DC46DE77587C53D1447236B7763E5FC2BB0EF4B1470550F34111196ABD76D6792878409AEDE6EA42DE7D9880F5179293468DEEACF63887AA4203BFA11A7AD4BFC7AD554CBEC079B6C07A9DB4146554C7E4129575F9D21087A5446929E773D7F1509C6BA2B319473C194765A1366C8D48CBDB7E7B9575F3CB878AAFBBC36EDF8C3951D402ED69AFE2DC626FB9B8875943BA0B48A840276F1B4FDAA58628973B712F1736DD3AF8B4E89CBB05316BA374A6558F3C7B0DB6A5ACE71DEB091E433E3B2D5694EC331130D7E55639971C77BFBDCC3BED796F937731297AD30EC4C8E79EFEEFCACBCD0270B91E52714E0A9EE6288D80738941545CC22856A1430EEB2BCE2DF0684394959A396C456D85A863FD5217433EEF88AFE35D77BD596A2BA08F74A7E06937462423AFB9152AB38D2D7D09EF5A8D674931462D0F8141CDB5E9B512DBECE81817F26E6138E55D940DB20D2B9F6D78BD8ACA9CF282D66D443CBCB6ADA55FBB22F116CDCB73E44E1E4DE3A36C3CDBF0D15887151FFB52DED118357B24AE9696EFEC394D6BADDB3C24B1B8E4C2E5DD2F83157C5C3069C266C92A31BBDCC474AE31A3678EDC7B94521BF9A371E1ED86B5FC8FCB3A76BDF89B181E12F35D938138678EE8A42E941E67CA23D173EBFDFF84F9B467DE5E8BFA46CD1282E657C3706F34D2CB760D83CA57673DEAAE9743F2DBC977B3EF9F23DE701A0395B2FBA5769709AF19EFDA03BC5B1537FA7EF923CB749DD089B57149AEE6AC5424AEE25C373D9AEF659192F39EB71DE7840774D1EF6D58D953E07F71AC936D7AF44AFBAAED034E673D6C93661180D6EEB4B18EB4EB30C4BCC40BF2AEF3660D01A33642B1FED591D32DA53078D70FAEE35DB79D4CE05143D0F85C95A711F3C1BB16A87759DEC8FD0BED0B78EF462B8D219823D315CE2A0A7011788E3C0B70CD06DA588F5F9375B66D7F9FF53C6795E86A315CBEF43086898661CB967D31E633DEADADBC4F8A48D3790B6816257BAECC37AE6D0FEC3AE675DF6DF2F188979C990F7BE68B0667911A5A77BF7E8F793E301FE6F3A20D68CD9E6383D405EC3CDA1F747645DA57F29E6CE3F9D867E174DE69F459B07EB172246BADD3B10E83E5C2AF79F74797E25D6DE79BB2E0CE22EC6CEF4C21FAC62FE65DF7DDC3542DEA70D223EFBDEF59D7B7899683D759F4FE058C77B284D73469D9CDDED1061113BBF43DB5CEA4D2B0F2B867DB754F88139F11AFCAA7FEBC75B459C06A2BEA7328C87594B7DF2AEBE9C29E5B7CCE6AB99598A5C4CD2C67B05E932721F5B286F1628CCF2D4726A2F01D4F377B9F21F6587410B3DC6DA8973DFCEE17C675B1EDCE072573DA6E1A97151ADBBFC9DDC6C9C3721BD7F9CAF9A61DD765062958CF37E9EB55CEC99346561D6FE73A0FAE330C28AEE15C83DA79C7B5382198AFC3631649E72FE2BBCE5A44102B33CF37A1B740D63C300F7EB4957B5D6DAFEF8252BBCB4CBF8BDC4E95F58B47C7D953E1DAB460CA05A64B9E95D6A015676614069CF4A4D927A2335C905A5BCAB7EE76B5DDF65AA1E3D156F770F09DC57A97FB26FBA340CB5FC2B79E564B93315A4397BB2A45C6708DDD5F72ACC7E722BE9BEDB7F3EDA1EF63284EE3C4EC01128F3C7BDF94361459A917AE30B684893449599A8C00199BFCB556045412E48D362D657B6EB7C858CD628696934A6B61C7B60E68AB35778F93CDD6A657186FDAC0B7739FC44C95CF2F464D632D9E83A37A7F15DFDDB6BBF9BFEA9AAB7DB45934EF3E791C3423E49CE453EE9ACE9E87A55D3154D32CC53362A3A5AB5C0EA56A35790C9137CAEBD8CE836DD12E24E66138F7FDD384FBC1367A55DE520BD11F026AFD12B63D5B227A3C75247C064DA9D6362169B645AE751DDBCD026F65949CA2AC9B1EB19D7DA518D1738BB5652FFEDED8EE17D80E69F3C9C8036F1D780BB38C96CDC8CC2AA17C04DF79F2ED55ED27192F936BD2D197B74C7D942DCCE6BD97B8E6ADE79D111B5CEBD74664607272B3D7CA9017316DF1B63A46657009FDA4D1EA9C5E4D1A74925F46D1BB75FBE5E10FEF1AA796165427B1619C62A45DD6469962C07A916D0D4BD9CE836DB196A888AC9D234E6A6E0FBE3BCA8C5B9B7C4F5BFC12DF7D6B19016279BE1FA24F47B731B999472298755858C4B885DAAA4D02BCE5C48DCE0951AA79ABBF5E6322F5ADA089091F430D355ED9700B362527D6DCEF6EEAF7761DEDD54757869296B29D27DBE3DB8FF66949936BAC1FFF29C3E7DE76FB17C5B4C5D7AA77790B25E1E1FF689D5AD99873DD1155A5427E006738B15E092F595CD16FED32DB64CCC315E51224D984B63DC4ADE33BFF0FC9B785D534B83D1AFF1F559ACD85F49556C4524BE2E07901331BA0BE1758F211753D9BB55226B19107E32E6FACF00B46924D2E4BD9CE836D3CCEE7DE423B1D6E4D5A1D8C6BCFC7D2E5FFF231A3F50AE3EE7297ECC4FCB694D34D98762D7C2346CBDE2F212FF4469AC5D3CCF09E7996C7BB3B6F0164C2A450247B52F6E8CF4CDEAE4F024BB4E7DBF2F5EDDD80EA2E92283B8D46A83A8820346F10B998F13C199F5DB18FE77B6BCC8CC576EDE735EA9D6791C215BE7BB6C86377525EA581265FE2F616E3BBB4E2A90679E5DD6D11B59ACF8910BB0D4F5BD49C1AF2A12AA24BF558305FF305BE2D21BA562715A7F719636CD53ACD77CF1E4C6529D779723D73308E7ACD3A4D0EAE2B7E4EB9BA3B3233B8AFB1ADA69A6A02D06AF38928E75C6212BEE5E7305AADF04A7FC4826AE674104CB5BB6E76160B224FADD50686DA6FBF1EBB99D572817153E5C1C66BD0EC73855247B42516CE1BFA529317042CE63C4FCEC525925B249CE30D3C1BF362B15569A2E0301DFB74D67A81F5648D4AED3D98BC08CBDEC772CB4DE7E5B0DC2B71A3BD8A730BACD5316221E1363B99E7EA3A1AE7EC45FEB554BFC46723E25F1EE3BAE59EE4D50BF7738E17A53DDF56793D9BB5CC893997F81EB2DE9D58997C576639F6C2B8887D6ADE8A8116C6D69AC5D68CF1913B7ED4E9C6B8711FEDD93246EF72B5F1DD2EF0EDC39254C7819677FED93A5646612B26F2CA1C2A4BF99E1B8E412A94B99F474B58887F306EE7A0895ACFC7C1779758B736CCC1620F93DA3E71BB23D2965CBDD14259EF1660AB5E6E890E1DE1AE2829CFFF305953D12C0BE5E3D4ECDA5F732E626EB9BB253A3557A5E837DF321EFE3BBCE351F0D496328E3D6F6E32C885C6744E79E03DDF55E380298C916D33B9EB0AE3BD7BFF69766ACDA57DDCA5987BD92A8FFCDD8551B66E51B6E67DAA10BF6FE9CC791CBD885183435A4C816E3075FBEDE109E1DD2DF7C491C9FA48F668B70EB5DE338610CE3E574B19D71D8FF6D9525AA4BBD4DD3DDF5D2720510D23B3F84BF8EE963E60C3E09CDAC8F3F07A2491899252D1401BAAB697687632DE2DD4A634919F1FD93B1FD19979D349C9C2032CF78ECEE98BA5C6A21E86B13B7F6EF1021466B88F2B2ECD57D259A2237701579B9F4449A48251C2B1301AD52D04A7EF7342A9A7808692E7DAB43D1C98E17963EE458D3A142B45145B980E183F5E0163538175D6D966F788B2984E72975220C0A1B9C31DEF5621BE9585B261A1B9E665A92153A573EA5B1ADA180B66045E5B6A99901D2272A0D2AB1F993FB527759A2728CC06B09420CED3A12D9AE94C8042746E4567DB08C9A01CE82D2E8CC5770BD7352FD7F4C4A4935BBBC7A2233742B41AA627A011ABED9661317EBA82C55017397BCD679C39B018ED920509F93BBD75D173C490A80B85C2E277064442DB8D92CFB7048DB6C6586F46DE40E12487E226B65DC2283C65D77F687C452042DA062A1A55539A730580A1A3711128235FADF4375A0A83CA83CF2CA87253D5E72854EB9BD6448381FBD41BDA76E827B69F5E03C123601FFC2A42B4CC5A4BCD12000A623E88ED284704034B85725D8A83C5F71407FC3D36F5E4FFD7D1F018EBCD787914851EE4F620C8AB1E041B123E7E6AE9970944DE0191C521ADA76493BE07A223709F190D04C57D6512E5F866F59FFEC31514847F83C1C71F550B76D66D05144523470CC463D5936889BDD29CB0E85FF33898809EEBA9E691A7CF840018C2D98552C5FAE47AC746BD5935E8F8A9E50BD2A04E60B79C35256BED5AE4DCC991C3B3281A14A5D4767469290A2A0BA3EB9AB62F3D36CADDA18028561515D2D0B125A9C587E260B61BC57F7A86423CA090B7A83F6FC13174D5E898434F48608C552C098103E939392FBD2A2C36D8CA71AECCE14CD0E8948C0533A2692D88E55F64852C56951839FA91EDA7562E0061133E7B9E7447724E208EC98068C4A211C4A98F353458144B8198F290302DAFB7723A151B0EC95DC782C1C8C0016F40B1380CFEC32514AA4FFE2893ACDD99630524B75387B604DD58927FC92A102C6AD89C08C7D6DA399B218DA00696AB7DCA02A3F181F02496BF3800FA89EDA756AFC0E04E4674BA79365342CCB6621CB32CB810EC394883EAC8B540A83478C696DC84746EB2CB7B1C46BF48A475E1E1526F327D3E9D3F3DC3619BD23B75641B3D08EBECA1EE612D22A4C30941215C33D2C3F242102CA23840E8E89D764ECE2C5B58111145B91091DB96DEF07C2A96AF581036A67CFCD4DA05143439C26542C90E142A92BF51A288A9309D457A206609438B79290E53180EF50667DD3070D0AE6684FC2BB9641AF2D5F5F7F3874B2058995A8D93E6F17998084D1BD0674CFE37C420AEEDC2F3A0F51C3DF914E1C74D8869B45EC672BB363813DFBCE3F6D2F599FADE7E6AFD350A56506AC3C08C6CF620BBAD80A8DD4A66B1D88FDFB210863C6118A37C4FB1E60D06EDEB27B704BAB7E0161741D5DA05C361FC7409077B34B7305C2237A277ADC7088F0F3537D8E9220E2268792D101688ECAEA5453BB573F1118DC03F16ACED364B275D6007E7CD61F01F7AB8220DD64CA039D1B2F913DAE0510C07D992148A902DA5E3296B310610861E0F69BDA7DCBF0D04EBF7220B0B9883D86EE2FD2661DCC6DBFB0F5750E846C935038F36977B59101E22621F4DD4630E6DE92DA105741386F90AF2403D565F70D24E9C8C2B5CAED986E361FB347EE8F11789820A0379EE46AC31D54797E540216B273F34932F6FC87D097286DE2CADCA7FB804037B116376B2754E2640809E188D8391ECDDE58C52CDFC96568260D1C84EE707A953C8C57203D01915A578A552C402E500806DCD9B183F74FA0562A082E0224989029DDAEAEC20485AD1826772E2A6D15161A3656FAF357EBA84824DA131CF52E95A57259809309508DE0535466CA1719A876E150C16831C306CB993671CBAAF57232537A68EBB5258672E6103C27FEA7CC5728A735407087B610D5A1652C15027D912BC06A01622681A50CBABA1508948DE9021B4C6E7D95B690F45D3AA643891DAE3522C7DB1F8BBF7611A3F5D81A2A97BE9953F4A3879FB21347BAFE24BA2FD796878C384FD1071073D3A1CFD6B4161A1488362CB2C4D472078373C59C0AB54D04A411C01F9BC88AD15708D9F7ABA80832EBBFB999BAF365B620CC1986BA2254E5FB3100715098FC189B596CBB9008CF648246D12270E665324729BAA72FBE912126650E736E99A96986B2054F8127A5181B0B872F17118EEAB2161D148436297507F8A3F59AE121AAF6A37054CC3664D580B6902317FEAF98A451D0F40B82D399740283F4D985D85263EA2C3735A8D834A4439276CA587406871B79C59B9EEB044D2ADA23880F09F2E01E1734FD2A43B463A79F747C2C861AAA52B617489C96B91B090E44062EB417946827CC5C97A7585D2D14F4CF4634E440309FFA9972B7684C566BBD3CDB35F971B328407BD825C55F4B92108E16A2454267C3E29A21FAD9E2E0EDE2351AD9391189584E76D8D19C5374F70F49F2E216169AB21F44978C4E37C7E22611C53A4A6CFE8724CEAFDF1A0AF0A854526BBF7ECF39BFC3E4E6DD99C36A537CA8597345722A20D52C8BE5DDB4FBD5E391FBC25F226CFA73C9E0FCCE8C1958C0E4081C7315C08854A8587A36AE09CE90445DA4361BD44C579CE28ED867701C1F55C40FFE912121684A8C5E9267B2F81B60A15EDB3606A269508F1E8FB6A182C3AA930ECC7E69C2252D6951AB5CED62F20E5A8D5B539C43EB4C4FCA95F0ACC85AD2A2B79AB84BC2D8174CA4928DA3332C59AEF95C4D7C6612F0E5BD6437A0244D71263121D814B3E6B93D96CCF0ADB4F97908871EB09A384C700065F042131006F03E81214EBF8965548448B51F67E4EF03F23917748C45B49115527FA62115A1F40F84FBD5F09DBABEBD5C8A7ADC559713D5444A15BF12A647DBE588F0464C2BAF0CC8118C727FF1D12A8EF403929CB558F6E0068379DFCB96DFBE91212568EDCD344620EC6D425907865BDE12160A3CB2B81B030A50131E3840FECECE20B4E5A69C985224A34B403731E32317FDAFA65BDEB73A835917852CE874550C1F8693CEF82B07C7AB19E88712713DB53EF7D70666251B44E49BC72ADA8BE958217EA0185FF740D0A6B93E76E689B71DBB908C2A046C298BBA88F2489F25A2CC8C5C2639622FCF74910348A53B0E466B54B56870965466520613F18AD5740747BD44993AACDB3982B20642089E6A91B615E8B83C904B95943A59CC7051F60E85AE52067005B85978690FD2176FBE91A1236E0C26F511F24ABD31D39444D03421BCBAADD49AABE9BF15A896097083A0F103E1B98CD574C9AFDDF6BD3D23DEC5AD8A0F09FB6E672EFE94C7BD50996B39AE690D5593C43383E416341782E29283F5C8C854985C7EEB8A5C0A7572EDE43912CE9B895ACBD2C98237C57B6544BFFE91214A24D3460D5F2A43CC2131647A58A265711531144A3CA1DFE33A148AFA0482E16EC0744AC5F7BF13BDB14DD575C34B3346B6DACAC51D4E43C21F3272377F1B16B233CC298DEB05C5CF25B9483B123BC545724978A749CC77AAF2CC68AAB6681F64C154BEC1DD80D24FCA74B488C0EB379D21D16B7AF81301E3162EEF5F17B9641915D2A92B729C3935E7AF0FC99C670E0A6296FDCD5AAE83813A1E7917DEA3F19B99727C46A5A3CFB7A8473D3AEE48C50D382D6EA87EF598885898547557D11F7FE47DA866E23DF2B3518DD1DA97E02DE80C27FBA0445AB71A737C7CC147D79146F5D8026F15753492851900352F23A24AA22515C2A3C94E9A39A8E23C9679F42058834EF50ABE8730BB63CF866A9DAED71217CD7BB95205AF275F62E57591F42E5121371D0D24BE48D05BCAEE4FBC4A9AF8D82C98387EF5ACD912B3E581EA380FC3E96C30DF740FEAEC8D5C93C90A88C8BFF02102802885B7240F6BA4E2BFDECE2C9090EE27AF51C1488D6BAD8DF6B81A82E0E656F5BA9123B3E80F97A3B72C59ADB13B7940549CF86161F157672C94EEC05103EB2DDAAB9B3174C59E57947C9BD20219B61594942B9C7C4772FA25F1B8983487801934D89BB8702D5A415C97E0C37113D46C5B0A481440A7236FA4524AC69ADE56529DDC487255043EA4A45EE140A8472625A2B13CD65C2C388BD45F445E77E7787FA8A3543A2760DAE8AD52322D106102DB68A4A8A505F03516CAAAFBD0DC3C67ED31CA2F1408E974EAAB83AC4E64E9D4A5D8D42DEA3E00D11B46EE66860FA72DB9B1AE466F7A62AFE73B0DC6B22245D96102FC2A019023E9043E9B20F53CC1410BAC370CAA2A94998EF58CB5A18BA0B43F3A69F21A11B04DA539F6E4E5F6ED7C7C9C495B03F4DECBFA12050A0622D0D437B0D43328EACB4D360F0F7D8D01ABAD01146237744C58472CEF295693512792201539761CB8977951E03A1DD303B7A4968F428B5B24302B5675791C8360CB76F82C63EA6A5712FE05A8B0D196A012D326B625E8A040597896E1BC2AC9CF573BC2A4FFD00EB474CA686671E9673343584FC3D8988B4DD4883F764424334CD4ABB9530FAE3EFBAF200095157F03B44F66A8CAB71C813872DE716732A1E0351F41D0A75CE1089E416A580007759F5C315106C2083251EA3501E5FA88E464F0545A62492D28B382D3BCA4B61F0F065F478806C6741FECAF96094B96074F78F5DD62928D48EDE547520910A97DD3C977770E06C0D70773820553FEBED505095D051FD8BE11EA04BF27569350E798F83C745E2F9DA2CF3A25717ADCAD52938F484DA3D1E389498AB16435F42C286960D24228CC77DFE310AE0E56252812839F4C5060479E0327A2D78C477624DA718EEB65EF4EA172F50AB324478A66DCD08BF63B931C6770A341C07B2D1EC9937BA1E91F015881722D64954BAADA4F530E409C3D6B90BBEC7231C82759615D792F4E193038D4A4374E42C4D6DEB4B38A82752EDDD64D0CDBB2500888A19793BCA4B91F0B865A4FD33A8FC74F239DBF439F1142CD72B2A39C4961A850B620F6B4BC9485740308ED246D373B147365517B33A228A0DCA316B3ECD5A10F20401FE76C41C27AC2A3D4641DF197A270C5A441E439C30A0C7F62F16060F56467772CCEFC5BD784461448E3AE2C9DC1B61A0B3A8454F8324D4616675B222BF5691519563F3D22D0B7559C8D663E884B7648C05C6C31AF5AF6F54972306796230AB5B75C8D5430C34768F8AE60449A828412E1306EED934C32518587DEFB40B7E9A29E969011D0D910A3016C2956B590C84C728A3876BCDC341EACB290C3342948CE0A9E876F4814FB756C4D88B130914B0684A60BA8284EAC89237C2DEA9D8BD2CB44E690529FA09DE0596B9180913094FB6140B39647E2013130A8D5027D1E81550749C853E9028B1E689EB0B24C8E6B796B4D1650BE1FB1A0045EF9A7529B774CF0B1EB90E48788432E67D936E9D047604226EAF9EED5643CFE20064D434B05FEC58AFB8486870162FC4E6481F10AD43BBD3751D310CFB0E47834D4938E5C548E43D126EDFC73BDF7B4261717B442931ED1B034BB53CD7B068396DC0BEC242DBD234A68DB0B7769E4E0654272AA0E5EF11B05D7C3C3C4EA95D1A769767BE0B5B6FE92D1822914A4AAC75BE654A05D287086DD78DDA2B24429E715BD0A58984D9F78C0845099AA68E22E8E5C7C3E394F19864A88B7A8444B549A11403B21FF32D0109AFF51428F04643E92214DE14B76D99492E993E500E58D4166055E005B4E6BE160A0F54C67A88E28F21623B28780F45CD056D3DD1E993DA2614E220264ABBE9B9EF221177652C15AAA2ECD3EB1845227A3AE49FE4028417036132D1EC1FA361075B3ACC132034AA4E3560AFB228CFB83B1D8CA499AB4098EB6953A32D7F5181986B0012A22778477829121EAE8C1EAE1C8D1ECB9DCA4C333F94B04246431DD4C1F79D48E4509096BD8D1A7D0F095D5BA381B0C3BFAD411416D2941208A7DA5664529D90D86462D78DFF4E4DA499808B7924686B81BAFDD64B2C9E2E4D7A54A03EAE2161131DFA465891D8B43690480D3D09D5EA09899622C11EAE8C7D5FECA6C3C88E48E499478E386A283D6B6300C16413899A1BDEA48CD8ABB88CA59EF2969F0E57665B020746E09278477831102A1214F6F5F1B0229F00A101A3D42B4A811199C83B207AC5ACE2A738F0DDBDD1529C649171B3E55B324C2E0B1A162B265CEB75B0072C070E2E10EDFCD2672DA1B4DA0471127102C44B2BB7442575B777D458452366A7F60209D6A43A7F0DB7F218CFB9B4A02990C825641D762C8231AB58C232244C223C44253A3B247D7BA62750B0D9BE08D9230952AC60CF8244D43B6B57C54B40E873A73F721959CF31F41931226CB7A4BE9DFC9242F5F2A9654078C87200E1F50AF7314B6BD7682BCEE83D83EC478C9B1485467520A169A2D1C9FDF2A038C8C4F002C3DDF1A8B30409C7403C6A3D1EE20BB411BF2D4828B88E44B02B9436BAC1F2A8B47483D19F501322E45794969F0D0F5A92C7EB5A8BA1F8928E38B43D0E89D143517303823E013B10222730318CDC3535E159D90E04EF1601289A395D93F2622C4C2678FFF60913F20914092D04D0D080D1F4843561669E0E310C554FD0ABF9DD381CEA7DE5B22111FD910765C0D09828CD47735F10E6DA692D101EBD1C40F42C0792ECBDE541BFC681444B0D2D81C4DA4C65B49988914C20F8020CFADAE753218DA897778DB404949B56F43482A75C67DD6D0B5FAFE8EF84C32610DB5B17DD09C456A6284E4A6A624A309ABFA0B89C071284748E6B402493B0B087D7BB9B7B9A2590A830D994B228A5614CAC42C2439834063DCBA18F9AEC704A1B0A9B7529A61737F9976F550BDE4298508854A34952A474412832EF027730B1916982B39142C5707B0EB0F12AAB502471F4BD9DCD42284C28F2A19D82CE4C7C8C45D1DAF15030C3039D98380F208A68CFCB40D890A2B851D5AFDC423468CD20ABAB4A98D26C43B50A078F60523E1D8E738391B887814934021E7F4AC9FE628F013CCC8643BE7038ACE82FB7BD1F5376761D80E8C9E4A156ADF95A034373184C1C26CFF9D0FD7A8B2F986FA41193DA31C646FE201CEBFB77F53624F217F11A0CAC9E679BE8DAB5ECF34208838C34A90E9382222A37B407C757072138081EB8DC4028FB0A85684D99E74A456EA9699836C092682DA0CAA63B08511C0F3CF550F9E5A17012857E98F1623DA9B7E38B4350830EFDC80589EBD93F230BA65E0BD26D2F81603D3077FA86F0A26820A0065D5FBEC5196D78F24B31AEC4C0A39534C45E07156C6D97B689E17AAD09B98A5C084C2DE88139EA6CDE6618142E186ABFD17A0F038DF094B823CD73B60E9EFF0362729A888D2AB79AF2CF0021BD06C104A1CDADF7FD08B3F7094D4788F104C711331C6E628336748DF7CFB45B2BA5E3D5F41906F910A6B471037DFADDB8ABDE063C6885AF24E5C66477C59689814728370410139A2E73D0B15DC3F047BE9CE8F3A2753A885374BD0CEC4342A12311604FEC3D0CAC5745ED1B6D31902606352553088366501E970982872769C48F12ECFA39F6226AD4CE71C0B581A7470A0D06B38E216EA8D6B20F21F1B010D5AB38A8C0647FDAD28900712AC68C769541D5048B639E34BD80168A43F2E0E4860326B7EC704873D2B836C2C14BAFDC0A5D6701D49A38F7F1219895B26BE81C40FD8A3CA8EDEED5D5783341C7A98983C803ED49C614D7C270120728AA1D0C650EA396A56A635942FF39288B8C5622657C0673BD5A42137D938E172830598AED40588B1F7C925E1445D1933EFC0AD6E2BAC11E597A4F268F4CCE95EB03C50E867A86A187D21B7CDE28A280D10DF611593112EFE1665F4181AC23A047AAB3F7769E282022A967A2A1893284A186B528E4230AB8B47728F4398F5D3BA721DE16824F448835270BD0576B4D157328301DAFE1606318CABE15D9B827C465E7C04A32F462C16F5AA82293C724E790BB7C980C2486DB1C558EE915F22771AAB5F536C6DCEA4413FB089C8B2A06C08ED47B186871529AADFFE23639151888AF1E34EF5AEE63E4528A59DE56CA8247239F82A0C6CC0041732953EE48F6D4179514C74764C5A96B9CFF1908E5F09AA73E2CE749386D86232AA7D106602349BC54397A249269C3607F575219D331AC6567D5668A28D5937F98438828D3230FB18A7664BCFA6ED4DE8341CDD3E415A23CFA3B1B0C30C54B549229274D65D47AF9AF0E439C30E4030C9AC7B787817630A0856F13C7036DA8F1CCD602AB1F5DBC631DAACCE25518F4A13F597294D2D6AF1E3094AA517AB99953EDE32B96A1E011C869C46B4DE91985D17C18A559D4B3B6A5445376F4D66C13057411648647C97C01058B84FB331EDDBC67AAA1D045CF72B0D21431C971EC4A5CA11C3718F20186D31D41DBC873AD226B68FC50D1A822674ADA2CC43E820537516AED22087A47A6347A5CE72308D40A26A46C347F1E0ACF8401AD9915050F3E727A0F85BEF5F916EBDE22417236C46AEA3B1472CAF8CD46EB3D14BC13E24679A71E3BE2F0AC2888971AD10B72CD91A83C51C8EFA310762844F42ECEB169759EDC659A89EE9EF25CF02F10040F3A727E7251966D387AB26A45948CC56A2351B8A43C71D0F84BDA133BC1500FAFFB9661C2FBEEF723C2818A62BC7C80A45866EAA395B01686FC3E0C710F83B69445BF65785659144429F348C88E260C66BC8642B259BE6912DE6E4A2D8DC63435906C5F4139BE04C1838E33B8747747C42D6B540BB202729DE41E839F8DFCEF9C763070ED08B871B90083F51528CD49A7DD99C0CB1D266B63266B0C81D7CB82471DF7303C381203069DFBD762C7A3AD98FEE2E3F4B03F133987582EE210FB511C687F28D07EBE563D14681E54DB72203CF4C8F5BD6BC223842E1A62D7E23D42B6537E9BCA5E1E6A461BC28DDA098776C8235679A8794E49D9AE4B3CDC89290A8A883DAA1DBD1A867C80E1A11D1D69CEB5111812A5A41D646EA8E44D6D270FAD2151E7120C31EF61F0A486A11DA06710E7453C58642FAF329D260C1E81E4F64C3B6CC34975CA5184C06A785018AA989C53260CDAF4495DCB769A4AFA0806DB22D70E61749B1B3024B4B45692A278535AAE253D0439577EE74F1C70406C05B3BE2CB75EAC660C25DFC18012A59730E4AEA9B7F1200DBC579298BD515B0349644B52F9B9A7E29538648F40727F571C922F56EBF6624FA55A0A75C501D9E1C0A2D98977E4DE9307371D68D2DE690781148702630C45E52E9706D4496A9D497FCF88F4F1EC5A9686B9A91DF9C1F9565A4A69E765B3C6A15EA360E2607E958D6CE76E8321FA4481E4AE202599638DAB7524CA6601430AEFDE9963209ED62FD60637523BC3D4B433A7319031A43DB1776481B4C222B501703ACA4211034B75839CBBBE19690B61286718E27318B4AAB27759E39B66B09650D20E0694DAA213FC0B1C541AAC44CFBA5FD8C8C19D8E6428A0A8CAA19611D058AA1CC8C521BE8B439983225132256652405416B9CD718F438789C93B6A1770E0497A87034A81515E019A78B95D7D28C8A521BE7B28060AC17A6C77CB87A4964A9EB68DCEFBA95A9D710D85BA43A18D11EF03054E68F3009A490710AE96067669A07775649DC35351B5871C208DD1CB8D11E20E071263A7ED88BDBE315D45B6A3E1202E4B6F51FBC3102BB28BA5815D1AE85D691828583BF38084AF373CA5B4B479C19CACBB6EBD08031B0C1BC0BB9B027578091D69D03AA0C0B15F8D437269E07771683E50B86AAB711F88587B8DFB0B539C6F31767847EC0443DF1F0A7BA5711559BD1AEF6DE48BA235B81E0A542EAC3723E55F96D73084395D1AF96062DEE22E973FA2036BE5B8D70F19FDD5EA8E607808854B99BD129293A79D7E0878B5646BD6241771A39512D1158AEC1291DE95089FBCAED93D7230326696A3D73B61D83AEF906819D7C7A4169E8B84C71DDA986DBF571008F6E0388020ED2EE60541D981820944DEDF995BD4608F8265BFC8AD58D17B405C81D631E0677F30BA768E7A0643B5FE0AD3C1D2F79A1A9CF821442F1037B8DB09EDC3D0232A7AF5DED70FD11B0EC5A521EFFDAB1D0E61B6D3E3ACD2802CAC0CEF525CC39A5BD2A78A307AC073D218E524F70E0EE3BE0893F82E342BC4336ECD8C2827EB9BFEA2849F018389C3210AB5C110F48F06834ED512772CA2340B8221A2806957FE21464D77CA5A037E0185E8016A9EB40F87A2E68407918C3067B3E6E071250ED5C56187C32E5BDCC6138CA5221392A39C8B882849CD3994DEC7675077C3AA21CBBB20D865A1E9B0627C4CCA07107AE4A81439629C54EB65CD8BFE80C044E110879B10544DDD3008307550DF64E4328062684805EC343E93D1F90182F10202BF82CB0E02B68E69E33488BF87B03C28564CC1A8A5AD1482E642501FEAC65267B6135C1CCD71E28A271ABCAE767102937F06F97B7216D0DC7FD27A57315A5C3A4FD23BC58876EEAC2721CBFF8953557E1606E935062605EDA142C866E4F942454BDF5AA5C4114722542E6863669F6174CD22AD9DB884015BF48D26E98318A482310FA0291F61A48D979582D05D101E8390ACB3C05C7514EF3A8B2868266892CB0B631AF533B8E502AC9C8DD47BDAA0949DBDC4E3521A181424172BC9844721594F5D29087D270828C76FD0FC2724A8CC041784DEE5A2608A0D43C46E5A1A80A44DFD086B675E9837A93F06221E0C26037D23ACED809246DBA282D145C7AA40F4285A926C36E7328128C105A25B60452E2FF4EA3F1B0D1A341D8BEE9AEB14E059A1208CA236E3ADA37B710D1A6C781F8D7D16A0B57E51C2A347941CB00E14D0AC2C305B03582A19C1BD9F950A985EE3A1C2913D2914C531B59C9AFA5B79CC0607FA3D16D64999E262B14ECAB4CFC0DECEB1A3FFDC1540B29D3FB7A71D90BA5B0700E9815577274E7594C42F83C3E39263D89D57A51EFB966B95DCB8E5F0882736239A70A007476EF66BF9701317BE92D37A0184B914250C55E4934031155860465B64B42E933B4A8B4251AD2357E8CA1BB4C49D5C446DE9C7FD34524CAFAF81035A86718B518B9E923842C8632D5EECDE8162BD0605AB5B917374C2DE3F5F472E8817CC9A468E56FEACA3584A1213ADA495507870325BAA0F8658F574B628663614E222E87F23566FAB3A8582D0C320D947588B12319020C70B52610DCB729F84555F90362746AB4964508B94698E7D11B7059D24565A96C52394BA7804C94B2D319DE65EA8FC3777893479B8A78006C278636988D2D909A9E8FED130F8E20A1656B59DED9A36C21046CD0ACC986D062CC4924F20DCC595159BADAD74348A4729B345D4586E12A2564E8393ACE351F745A3BF45EA091AB4501550B27F80C5606DA20769D27BFF5AB59E12D69C7738E0BCA5932327B3DD48FC6F7DC378A0287AF85A22E161CA4C0FFD2D4B7CEC739DE2A5F64EC57AF28AD684ABCD3E4B08E6B18E85A3D7E2F08108BC14040F50667E8C80D5DE050F19216F363616CB0F1707FAFACBBDEF59E44D948328D0B4A37582E0D05B902D5D3439E57D2E103A113554B631BC001D1910CA4A29F0E8644E0F1D2EA2B2C7A00B0654C588D47C28D49163CEB97D080B962B00A1CA4B205883324E93F4CEE3427757F1329426E544E31174190A1E98DCA390CE36768C33465B117FA242626F89212A3CF7616463C0AD58DFBCA3F50884E8B31DEA963ECD3E8B94661679C884EAE486F846478BACD2D7626092F0382C492DED31D02C72D6A071BAC9E604B44DD68F60BD4DCBD02E21D00E08B46331410CFA9A098A09DD2BFB5221F07864CE0F5D4EED00EBD93FFA5CA113DD92F662863388276EFB0CA39B9690693B5A8F21309FD372A0D246F9504B1009FDBFD1B4008992D4CB4A8DE8B1C8FC3816C981F61088C57CC343524B2A048844E23A0F7E2B34F4C92D2F31B0E45BBD146C38D603311073C328366D94165742E061C809C13106672268493FB0570041693A393AE9D43F1832F6212C38779D629DCB6B08BC0FB8F5F050D2BBD0837C9413EA6A264D2B455A76163C1299EBE3B3E0D7F70E85AADA401B9327988DD53F844769F1C0FB3510AA65CF97C772C0E80B0382B132FACBD4BC12020F453E83609FEFE310A0A826E14EC074930487CA2C6059B118B9BCA3F50E048DB60202AE8774694050D0CF572966BCE652AE2B0F838722737B7C18EC3AC83B95283E7F8A9A209BD01437FB67B0E09E30D161A3F59E3AD05B81792F067162907430A3506C1D759C14FB4A083C1099DBE3D7BA7680008D9D7AF27C7159675253403F83C48FA88FACFF9D21905E236042D0356AC062FA533BC7DD4C6DE5691DC8F27356FB489C2BD6E26BFD085090CB315E43215ABC9FC3A46B8750C44C30EEA46088C78801CCD8A71C43F178E92A79A81E8734DF1E658E91B89F0E86C5D46299765DC388B21CB43FBB98F589D1879C1C10A14508C4E57E0111AFB8DB485B8E0D424B18EA09402A21FF1A8413A681BD3DAC50FF6AE2513D103992A3C95A771EE774F770C6033D1519AE145210603774EB4A7223B1A75172F60C0DDE994E5E8B5A861666FB5AD4DC716B5A5E0341C43828A4CA5145EF9995DAA27A18D26B3E6E8145FC4F6745033D9EFE6358D4243201D140B23F44433F82BCC15AB0A9B1842B58E8E2B8EC9D09BDA453EC28404453CDAA71B87ECBC88F4B6F25AE140C8F44EA97142D026D748EBF59B4B0EEF4462F1D993E1985BAA2DBB2EBCE129205D5DF87625F65923767450F898E62645984629175482128B30E7658AB353C14599C5D38B57C7ECA497CCC8792B340A5542410631A52ADC9C70DCA76E7A893674B7CAD32AC57FBC9B88E9A7117D5C98E302A135C4DF4461009342E96C985C7228B3B13181F18EB492ED22E37AC6920AAA0A5A37628179382ED0348B4865F542E226139C4AE3CDB88F8A09D00C2A16C259AA29C8D7CD4996169A5B7513D16596C0C58EB62E1C6720A44D9DDDA7DD1A84FEC5956FAA60E3B7A92EB07901F5F1AC1DE2874455D84AD958192552DB5AD015860AC6B53CA62D423939D57CA850724359092D19B0F29ABA71408DA43812E34377479E1685DCA09C9BED507F58AF18DFDBB8446D487DC447D2665DAF4F2B10A805118795649274E205E5C564667ABC7260B3FC90A2AB34FDE0002BD37B07FB19538A6ACA27A44F446A83B4AEF85222C0D22960779B4189790759CBCD0CCE2D3BDF5BE16009386F4243C1DF7006889628AEA770A04C2315E7A2D53029DD210B4BC0841B495853D045B017787D5B923492B5DD0EA61C9F238386B269275701B4280797615B767E7D26998515870CF55F564BA1A8DF1384F3B842575B66335059983FC51D44DA5B518981C3C8ECA79EFBB23061DBE375A90D79A477B3CAC579CE7FC1C81BD05D11F9C83381110D3A6AA5A146B8AD11D2DAC74C2ABC7259F2040EA4610ED112862F1E5AE2F78846960FE21AC38EB50EE925F63602A31F251256E1820EF4131A87072D77AE1D50393E5716092D4999C1868A5AE7800A4BDB7516FA3FD892CD30F2D03634A1741A8DB73AE513E080205B42DDE48D2CFBA205F82E0A1C96720B4E02353FD425710440F58D191E644D96774C184D2908DD63B1864BB1BC3DE6A0ACF31A8692D0626084FA2723AE291B6E0193090A58B2B080C92B599EE7180C0E535067A2DD83A293C88CA290635B68DA2B54E5BA6113D30F93E04695AFB97207812984CF762D01F55553C8020AE85C0A4A03D3909B487203F86A0D197406052D0776F96F5902BFC0082B6F2E1B67A5CF21904661BE459F7A110301A3700828C1C06FF902E5853DE37622FC580DBBEA2648F412B6D47F2E7C5A72F806072D01F8360A9F3793E312B080DED93018238BD345A5861C115627109037BB7E5BA7FBB7E07035EE929340F483EC3406746DB33BE663100831CD01EB6E8D06DC6D518A620B4847978A55F1084B2B57B3A95D4E840312435ED48F6BA160415841A1E5B89F90042780842CC5F06826A84D67720E443EABC82A0D11490EC781FB674FC557763F3E0E33310A2F70C1F294D00A1E64C7A1A2805B8077128C5469A365BC36B0C2AEFB4A267F4EC0401DEE78EE2CF4AE4B80081C9417C0881661B4C045811E808B20101664CC0AAC348D419672FD8DF2B833EA91ED9CF9839AA0423ACD0B6F2D9B67998B15A9A1F89C9C7F11442C9DE1F79E421A1D28789486759A19B3672241D84224B560F2FBE86C146918FACA6BCB5442C16F935345A4C4A381494BB86B5589828E8AF6F227D9CF2399EA4424B23FF537DA7DA31F8D8067B8550EC2349F5458B2FA1B01882C5193D149F866A44AB4AB95E90FF8A792D35EB25510AA2544B53FD9A4719AB45C2328B9FD2423967F8CCC6EB58B3753B1253E94D274DC96DE9337EB0E416150A7A0D85D9999EDF93CEFE53824996540DA16BE85AD5E0E1C56AF5221894433D9F432A71C380CD60E805355640A1076E9AC86E28D4D423AACC5EC0B0AFAD493C73A3550E2B06F6646BEE837D897147B81D479C7D1D892007C3C38BD52262ADA1263A9D83F0C55A618E7C79309E30710A29FD1DFFE6CD6DA7DE5BD9A8BD7F362CBEC679A69FFB93AEE64C445313258AF9B0112E6B9130B1481681274A2832CE7793BD78DB4714C5951E49C738911AD5645F23971C4A285E00612126DA657DF16C9D81E7EC622854144E806A290F46DE7D5D143CD258FDDD5A6CDB52F339DDC37A205A6E70D3266098FB88B40F93878182EE5A766A2FAF8DBEBB36689C0CCCBD2BA82A52202A812C66C9515D8D8349C3E324C8E2DD0FBD240A95814C8CB2CB5B47C899FD44D02D755464EE08BD0BC13EE5E7D8389550824A2D81A60A17AFD50B1E6BACF961C24F3C00A01A415422C62CB41B89246890DDA8D756D0E5E51A00140E3270F2AB7BC51B3A619C3BDE40F5C35F1D803001B813807D0664DD0310B5035CC220E3AC1D646BA0689FC166CAA9BD2801D6B0228DB3C527016855F71FAF7E983D5056F2EF31C65A1E1E00CBE1E1591F00FE1B7AE069068A4E4EB2C74846BF86B627F40EFB168971779AC6978E2680014A0614513C05D5DC7F06FFFC9A7FDBFFC705C8DA5AC5F98FD6FA4E36A521614533DC3021A5F9FE6751077C0D004B734A75D23D0010C5F8528298C151ECE258B6FF1E5CACF5890F39AD662C94148094C5A946A90806EDF5E108A0520613823752EF01D07646413C3673D2EEA8B2EFA098335A9CA909B110019380C781356BBBE20804DC5411916FB9C6B46F702634A53031E35B8D4987AF3F8320DFA5BEBA1B198E31258CB7412379904C59D32855589661E0C1C56718E8DFFB6EA1984B316872FB75B4FE6B18A7E03B8ABCE082604A7D12562B3B08BCA93E3BDD748640BE604751FB562C44C0A4E059548DF708B021208A9A90B51318A5F2F6192CB8C4AEB6C07B10D0FED1CD5561B83B085CAB1E845AE568154FAE5D8541F7C8E2330CF499C59C5C1D9B050C2A63B2203297C422ECFE192CB8515593B0BF16035BA7DD2F4AF884416B7947D2672BACC340E5A0852759E034AC022C353DC4A0D0118316DED106430EC2366403E3655E60F0B3EEC49718785CF129067D8F819D855AF1BCA8B3B37127D86764C12D44ED4FF302037B6D315372C841386180AA6A23D9E18A7A35C03A0C4C0EE29347B7B061D0CC3912733D290455A4A8F847B05EC6E4B66B626081387BCF14BAF50C81C6902649AF0959058107179F406075BEF62E44CD8F02F2D3713172404D887F060B2E68B5B5A3F50E06165EA641389F30C8E82FBB91E410D6626062404F30281B06D555E21D06E50106F1C551D8050BE8F4F6FA088395C641F768E2FB18745F6ABE86013DC6E030BE346D69AC54EF54E247636072C0EF9D858141B87616AE60405B02ABCDA97B1F035EE82A758F213EC1C06765794B3B8B96E41E3194BBA3E8BE118FCFC8826BD34477EB45F6E26AB4506A73C27767C15C05A7487DA91878F0B0A57732722604D12010F355C520A12AC63F828A1654295C02C0ED239E648F00601ADB46D1AAF09601E071C36700E863BAC53574BAEF03004A3B02902E4840D8AA8294ECBB0094B41600938027C9791B01ACD49461EF39C35FE6920B864E273F045D67095C83409BF4244B71A1D3A32320487547D13B33AD82C06386CF201811C1E0D9B28F2088E50441BE2005BB870401A2BF0FC15A4FC9A386ED490FC7BE832099BF5C829C753D06B545CD521D10309E585E21A05681352B734590EE6EC402423B8A4B7D048F1B3E43A0C659E042C98CC322D65C45C82071CBF39519EBED95D15B43695DBA0CDCF04E77E7007D2BB17671C5EAC8815F088109C193D019D306019B6D8839CD15051D594367A3A50AA62A2276F61A031383BC656429E50306A4F3FD9464D3B8C9D2F871F7F8617BDCC2B2F3208295DAE81038C9D005B995841EB9FE91983295D1E1FC1502697B6F273EBB4977082C8D1F768F1FB6C7B133BBEE06021A402D356939C5AD56718FD3FC08B398712F012853B70FFF80CFE38488D09E47285289E8845E971E038F1D3EE1DF3A10675FA8DE0668E1193419278891CCD13F230A0D9DF0AB937A8140A4B8C5D0890FD3D60081D05208500C89C663712D042602FD712B95B44140761BA09375D76163392144323F1383C9C0150422EF9C03BA95E32B82DC94CC4AB223EB8216CA009A47C61D00FB84934356DEF8C758AEDE099D7B204D596E684947FE998C07666C9B518C4F63A89E7ED30E40A4231019AE116602123359138B8538A82058F9F3AD868471B8E79AB63D0AD65E25E718543570A5C6C53E829A9E88FE9D9730F0A2CFE247E3742988D2C59BA2FC166DF6B5DA76D59B328A2EE30E04D9D8C2E92C0BC986598FC5628650649DBD88AEAB8C4658C9A84383A1B8AB870B28F8B3C220ECD06764403714BC028AAEE5EA4554448EA864580B85C983CD94C304A710E383348B09850ED0113B89F094287F0A2596FEE6D46BD1CD7B0545D93A34A4D22761FB564DFE211DB326F8A0ADB8106E09797AB412090F267A7E180E253A50DEA7DDB89F1F6D868EA887106CB652CE3819032C1B41D7E30520C86EA03CE95AA927223A4D1B1841027B4FA08BA7DDE54098489039B6495641FC1E102A08A8E3EAFAA77E00227F0910FA6FF29008371A0A34A4DCC34D878DC5A2C5D615397FAB91F0B8A22181E1E6DCD3A3B3B12D58D82FBD4664566B029966DB1B105DFB141BB1575AC2C7CEC53D10114B48494CD36A33F87AE2A49BA0087F6D20F211081309362072CEE9AE12FA8084D5D127717330A1EC56C58A1A22D16EAC87F97D2446725E362436832A7B93D42C464DF5297CA8FE6C2E694B05C2038C0387D4127AD3DEE390471251B7395B598B593041A88421110DDA1259AB9DDFC5613F36C58F4618F7C6B6170042CE4851249A4052EB5A91F040A3C64B37C13C455AF650540842ACE21A6B0BDE2A17471D4243B837EA4528CC1BB1A6254A7740B13B1CB574D20B45652DAF85C2438E030AD6B4B30748C43D128C6126ACE624F70D89DCAB21915E3B99D6DE34D541B7CCC3614B0010981A6FBD6F1AD4CF621C4C24B22F2291183A0F2E8E0944B2B963880B0108B9024B9D4283DACD57404C2D51B72932C8649FFA92AAEC7ED2417411BDDAF0F7221087C351BF3E121E801C48F82A1E8804F98AD5ECAF592BA12110434BA01F72AFAA25F2751CCA4C619C3884805258E0C0056E4CD6A4F9834DB50407938872C0E181BEA4B9E28808692B551337C5E06EDC06129D7518D20B247C82086DC665ECA399ABACA163983C423D68350F498C0C9375290C1E8A3418E416E8393E12069E8B453C08CDBD551C6AC89CC6C1114D099FC068BD04C166470CBAE3D2404B15D98A6C732A3BB2B7B28EBA06E5C540983C800CF6A6E9BCB377A040F3B41B639466D62E454130E1814585D378110A0B66DB20DF384796CA1A6A2174D146983261C4B7D06D1F8084472515898AEE1D35707EA42B93AF38EB34BADEB82377ED96B9E550E6E111110EA3F9F32B28ACBED4EECF38E796CA22B8148C9942A4A723AF17B3345B806FBB180A138A6650C8E908FC4826D25C30CC079BBF2DFF86DB381D2867AA763AAEE0E07396FA1E075B41EE996C5C25FA67827091FF5D2C111EA51C30C458732C8F2422FB82314507C54055C3F298138011C7E3F844946A18B5570695B9BC366D29F6717B6E6B0012998308DE24CC6B913081E8DEEE026DAF1E5D1A792E18C30B5AC4EC2DB40E13D5368E06465D043B1A9790A06DE0509C235C4544C40D4FDD90A83DB70ACA4832F6CB691514D1C3960A05941561AAD80328CA2C5C8918F5CD0D7E17123F3352B51D8A8AE51AAD17409045392D11C8EA61707DCC150087DE904C9D313015CD90D7A20081B0094005EF32A2079FA380A1B398E090ABCE00E8B840270A7872B88C827524B350B7921D2864180D3ABB932AC6026434192E8B65C1A2961305B18DFA43FD50F7283471C261ED6272679DFA011350F01C6DC4AE9D8A7A3815114B4889F450645C4C8230268B56B8E58B7130698886837808293FC741F524C638E890552D6A6C531A842E3A795F83A1ED42114A7628077B19050C4DB704CA28AC352923B9300C1008DD331F1C89B6E9C8827E64286344FCA086960606D84528B210AF68060B56D2F1B2984B600433B96AA79A1C69B52C90CB02D943666F689AF80A862A174445AEBA9CA18076968E8358C249CBB9E2650D79874343B765CC24111CB8272ACA278058EB6A45768170245AC598BD07A762337730D4026FFC11486468079A6AD4266A18B55F1E1226136C48942286C1037B721E64D404CA0AC5E6435B32BC6D88B33C9068298BF76DC45E01614B6B7D5AECE663606448B1930158F38EEC4A18920B84C3907BE8E1D17BC61107CCF5C0CA0812317190A5F45F2E0E260EC97010F799FB7B30A0805E54416E4561408D631D2864F940BB8802B5839BD5E7B140985250908FC7D";
   

  }

  /// <summary>
  /// 根据路径删除文件
  /// </summary>
  /// <param name="path"></param>
  public void DeleteFile(string path)
  {
      FileAttributes attr = File.GetAttributes(path);
      if (attr == FileAttributes.Directory)
      {
          Directory.Delete(path, true);
      }
      else
      {
          File.Delete(path);
      }
  }
  public List<FileInfo> GetFilesByDir(string path)
  {
      DirectoryInfo di = new DirectoryInfo(path);

      //找到该目录下的文件  
      FileInfo[] fi = di.GetFiles();

      //把FileInfo[]数组转换为List  
      List<FileInfo> list = fi.ToList<FileInfo>();
      return list;
  }  
  protected void getExcel() {
      String barcode = "180306381N050039";

      string filePath = @"d:/HFMIX/";
      String fname = "";
      List<FileInfo> list1 = GetFilesByDir(filePath);
      foreach (FileInfo fi in list1)
      {
          if (fi.Name.IndexOf("RPT") > 0)
          { fname = fi.Name; }
      }


      StreamReader sr = new StreamReader("d://HFMIX//" + fname, Encoding.Default);
      String line; int i = 0;
      String time = "";
    //上密炼机有上顶栓，下密炼机没有；有个station的字段，区分出了那个是Mixer1,那个是Mixer2
      String temp = "";//转子温度
      String power = "";//功率
      String energy = "";//能量
      String press = "";//压力
      String speed = "";
      String Position = "";//位置
      String Mixing_MixT = "";//侧壁温度
      String Mixing_RotorT = "";//转子温度
      String Mixing_DumpT = "";//卸料门温度
      while ((line = sr.ReadLine()) != null)
      {
          if (i < 3) { i++; continue; }
         
         


          string[] tempstr = line.ToString().Split(';');
          Double d = double.Parse(tempstr[0].ToString());
          int ii = (int)d;
          //time = time + tempstr[0]+":";
          time = time + ii.ToString() + ":";
          press = press + tempstr[2] + ":";
          speed = speed + tempstr[3] + ":";
          temp = temp + tempstr[8] + ":";
          Position = Position + tempstr[11] + ":";
          power = power + tempstr[21] + ":";
          energy = energy + tempstr[9] + ":";
           Mixing_MixT = Mixing_MixT + tempstr[18] + ":";
           Mixing_RotorT = Mixing_RotorT + tempstr[19] + ":";
           Mixing_DumpT = Mixing_DumpT + tempstr[20] + ":";
  
          //msg.Alert("操作", line.ToString());
          //msg.Show();
          //return;
        
      }
      sr.Close();
      string sql = "select * from MENSCurve.dbo.Ppt_curvedata where barcode = '"+ barcode +"'";
      DataSet ds = manager.GetBySql(sql).ToDataSet();
      if (ds.Tables[0].Rows.Count > 0)
      { sql = "delete from MENSCurve.dbo.Ppt_curvedata where barcode = '" + barcode + "'"; ds = manager.GetBySql(sql).ToDataSet(); }

      sql = @"insert into  MENSCurve.dbo.Ppt_curvedata ( barcode ,plan_id,start_datetime,Mixing_Time,Mixing_Temp,Mixing_Power,Mixing_Energy,Mixing_Press,Mixing_Speed,Mixing_Position,Mixing_MixT,Mixing_RotorT,Mixing_DumpT)
values ('" + barcode + "','" + barcode.Substring(0, 12) + "','2018-01-01','" + time + "','" + temp + "','" + power + "','" + energy + "','" + press + "','" + speed + "','" + Position + "','" + Mixing_MixT + "','" + Mixing_RotorT + "','" + Mixing_DumpT + "')";
          //txt_dep_name.Text = sql;
          ds = manager.GetBySql(sql).ToDataSet();

     
  }
    //解压缩方法
  public static void UnCompressRar(string inputRarFileName, string outputPath)
     {
       RegistryKey key = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\WinRAR.exe");
       bool _existSetupWinRar = !string.IsNullOrEmpty(key.GetValue(string.Empty).ToString());
      
         //获取WinRar.exe路径
       string WinRarPath = key.GetValue(string.Empty).ToString();
         //rar 执行时的命令、参数
         string rarCmd;
         //启动进程的参数
        ProcessStartInfo processStartInfo = new ProcessStartInfo();
        //进程对象
       Process process = new Process();
        try
        {
           
             //如果压缩到目标路径不存在
             if (!Directory.Exists(outputPath))
             {
                 //创建压缩到目标路径
                 Directory.CreateDirectory(outputPath);
             }
             rarCmd = "x " + inputRarFileName + " " + outputPath + " -y";
 
 
             processStartInfo.FileName = WinRarPath;
             processStartInfo.Arguments = rarCmd;
             processStartInfo.WindowStyle = ProcessWindowStyle.Hidden;
             processStartInfo.WorkingDirectory = outputPath;
 
 
             process.StartInfo = processStartInfo;
             process.Start();
process.WaitForExit();
             process.Close();
             process.Dispose();
         }
         catch (Exception ex)
         {
             throw ex;
         }
         finally
         {
             process.Close();
             process.Dispose();
         }
     }
    protected void btn_add_Click(object sender, EventArgs e)
  {
    
      //Dictionary<string, object> dict = new Dictionary<string, object>();
      //dict.Add("@PlanID", "");

      //DataSet dss = manager.GetDataSetByStoreProcedure("ProcPlanNeedXCCheck", dict);
      // msg.Alert("操作", dss.Tables[0].Rows[0][0].ToString());
      // msg.Show();
      // return;
     
     
        if(1==2){
            try
            {
                DeleteFile("d://HFMIX.zip"); //删除文件
                DeleteFile("d://HFMIX");   //删除文件
            }
            catch (Exception ex) { }

            toFile();   //读取字段值写入文件

        UnCompressRar("d://HFMIX.zip", "d://HFMIX"); //解压缩
        getExcel(); //读取解压文件内容 写入自己数据库
        //DeleteFile("d://HFMIX.zip"); //删除文件
        //DeleteFile("d://HFMIX");   //删除文件
        return;

        }

      

        if (hidden_parent_num.Value == "" || hidden_parent_num.Value.ToString() =="00000")
        {
            msg.Alert("操作", "请选择左侧部门节点！");
            msg.Show();
            return;
        }
        add_dep_name.Text = "";
        hidden_dept_name.Text = "";
        add_parent_num.Text = manager.GetListByWhere(BasDept._.DepCode == (hidden_parent_num.Value == "" ? topDepCode : hidden_parent_num.Value))[0].DepName;
        add_erp_code.Text = "";
        hidden_erp_code.Text = "";
        add_hr_code.Text = "";
        add_display_id.Text = "";
        add_remark.Text = "";
        btnAddSave.Disable(true);
        this.winAdd.Show();
    }

    /// <summary>
    /// 点击恢复激发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="unit_num"></param>
    [Ext.Net.DirectMethod()]
    public string commandcolumn_direct_recover(string obj_id)
    {
        try
        {
            BasDept dep = manager.GetById(obj_id);
            EntityArrayList<BasDept> parentDepList = manager.GetListByWhere(BasDept._.DepCode == dep.ParentNum && BasDept._.DeleteFlag == "1");
            if (parentDepList.Count > 0)
            {
                return "恢复失败：请先恢复父级部门[" + parentDepList[0].DepName+ "]";
            }
            dep.DeleteFlag = "0";
            manager.Update(dep);
            this.AppendWebLog("部门信息恢复", "部门编码：" + dep.DepCode);
            pageToolBar.DoRefresh();
            //左侧树刷新 
            EntityArrayList<BasDept> childDepList = manager.GetListByWhere(BasDept._.ParentNum == hidden_parent_num.Text && BasDept._.DeleteFlag == 0);
            if (childDepList.Count == 1)
            {
                treeDept.GetNodeById(hidden_parent_num.Text).ParentNode().Reload();
            }
            else
            {
                treeDept.GetNodeById(hidden_parent_num.Text).Reload();
            }
        }
        catch (Exception e)
        {
            return "恢复失败：" + e;
        }
        return "恢复成功";
    }

    /// <summary>
    /// 点击修改激发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="unit_num"></param>
    [Ext.Net.DirectMethod()]
    public void commandcolumn_direct_edit(string dep_num)
    {
        BasDept dep = manager.GetById(dep_num);
        modify_obj_id.Value = dep.ObjID;
        modify_dep_name.Value = dep.DepName;
        hidden_dept_name.Value = dep.DepName;
        modify_dep_level.Value = sysCodeManager.GetListByWhere(SysCode._.TypeID == "DeptLevel" && SysCode._.ItemCode == dep.DepLevel)[0].ItemName;
        //-----------------------加载父级部门下拉框数据
        modify_parent_num.Value = dep.ParentNum == topDepCode ? "" : manager.GetListByWhere(BasDept._.DepCode == dep.ParentNum)[0].DepName;
        hidden_parent_num.Value = dep.ParentNum;
        if (erpInfoManager.GetListByWhere(BasDeptErpInfo._.ERPCode == dep.ERPCode).Count > 0)
        {
            modify_erp_code.Value = erpInfoManager.GetListByWhere(BasDeptErpInfo._.ERPCode == dep.ERPCode)[0].DepName;
            hidden_erp_code.Value = dep.ERPCode;
        }
        else
        {
            modify_erp_code.Value = "";
            hidden_erp_code.Value = "";
        }
        modify_hr_code.Value = dep.HRCode;
        modify_display_id.Value = dep.DisplayId;
        modify_remark.Value = dep.Remark;
        this.winModify.Show();
    }

    /// <summary>
    /// 点击删除触发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="unit_num"></param>
    /// <returns></returns>
    [Ext.Net.DirectMethod()]
    public string commandcolumn_direct_delete(string obj_id)
    {
        try
        {
            //判断是否可以删除，有子菜单禁止删除，部门中心禁止删除
            BasDept dep = manager.GetById(obj_id);
            EntityArrayList<BasDept>  depList = manager.GetTopNListOrder(1, BasDept._.ObjID.Asc);
            if (depList[0].ObjID.ToString().Equals(obj_id))
            {
                return "删除失败：顶级部门禁止删除";
            }
            depList = manager.GetListByWhere(BasDept._.ParentNum == dep.DepCode && BasDept._.DeleteFlag == "0");
            if (depList.Count > 0)
            {
                return "删除失败：有子部门挂在此部门下，禁止删除";
            }

            dep.DeleteFlag = "1";
            manager.Update(dep);
            this.AppendWebLog("部门信息删除", "部门编码：" + dep.DepCode);
            pageToolBar.DoRefresh();

            //左侧树刷新 
            EntityArrayList<BasDept> childDepList = manager.GetListByWhere(BasDept._.ParentNum == hidden_parent_num.Text && BasDept._.DeleteFlag == 0);
            if (childDepList.Count == 0)
            {
                treeDept.GetNodeById(hidden_parent_num.Text).ParentNode().Reload();
            }
            else
            {
                treeDept.GetNodeById(hidden_parent_num.Text).Reload();
            }
        }
        catch (Exception e)
        {
            return "删除失败：" + e;
        }
        return "删除成功";
    }

    /// <summary>
    /// 点击取消按钮激发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    public void BtnCancel_Click(object sender, DirectEventArgs e)
    {
        this.winAdd.Close();
        this.winModify.Close();
    }

    /// <summary>
    /// 点击添加信息中保存按钮激发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    public void BtnAddSave_Click(object sender, DirectEventArgs e)
    {
        try
        {  
            //添加校验重复
            EntityArrayList<BasDept> depList = manager.GetListByWhere(BasDept._.DepName == add_dep_name.Text.TrimStart().TrimEnd());
            if (depList.Count > 0)
            {
                X.Msg.Alert("提示", "此部门名称已被使用！").Show();
                return;
            }
            BasDept dep = new BasDept();
            dep.ObjID = Convert.ToInt32(manager.GetNextDepCode());
            dep.DepCode = manager.GetNextDepCode();
            dep.DepName  = add_dep_name.Text;
            dep.DepLevel = Convert.ToInt32(manager.GetListByWhere(BasDept._.DepCode == (hidden_parent_num.Value == "" ? topDepCode : hidden_parent_num.Value))[0].DepLevel + 1);
            dep.ParentNum = hidden_parent_num.Value.ToString();
            dep.DeleteFlag = "0";
            dep.ERPCode = hidden_erp_code.Text;
            dep.HRCode = add_hr_code.Text;
            if (!string.Empty.Equals(add_display_id.Text))
            {
                dep.DisplayId = Convert.ToInt32(add_display_id.Text);
            }
            dep.Remark = add_remark.Text;
            manager.Insert(dep);
            this.AppendWebLog("部门信息添加", "部门编码：" + dep.DepCode);
            this.winAdd.Close();
            pageToolBar.DoRefresh();
            //左侧树刷新
            EntityArrayList<BasDept> childDepList = manager.GetListByWhere(BasDept._.ParentNum == hidden_parent_num.Text && BasDept._.DeleteFlag == 0);
            if (childDepList.Count == 1)
            {
                treeDept.GetNodeById(hidden_parent_num.Text).ParentNode().Reload();
            }
            else
            {
                treeDept.GetNodeById(hidden_parent_num.Text).Reload();
            }
            msg.Alert("操作", "保存成功");
            msg.Show();
        }
        catch (Exception ex)
        {
            msg.Alert("操作", "保存失败：" + ex);
            msg.Show();
        }
    }

    /// <summary>
    /// 点击修改信息中保存按钮激发的事件
    /// yuany   2013年1月22日
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void BtnModifySave_Click(object sender, EventArgs e)
    {
        try
        {
            //修改重复校验
            EntityArrayList<BasDept> workList = manager.GetListByWhere(BasDept._.DepName == modify_dep_name.Text.TrimStart().TrimEnd());
            if (workList.Count > 0)
            {
                if (workList[0].DepName != hidden_dept_name.Text)
                {
                    X.Msg.Alert("提示", "此部门名称已被使用！").Show();
                    return;
                }
            }
            BasDept dep = new BasDept();
            dep.ObjID = Convert.ToInt32(modify_obj_id.Text);
            dep.Attach();
            dep.DepName = modify_dep_name.Text;
            dep.DepLevel = Convert.ToInt32(sysCodeManager.GetListByWhere(
                    SysCode._.TypeID == "DeptLevel" && SysCode._.ItemName == modify_dep_level.Value)[0].ItemCode);
            dep.ParentNum = dep.DepLevel == 1 ? topDepCode : hidden_parent_num.Value.ToString();
            dep.DeleteFlag = "0";
            dep.ERPCode = hidden_erp_code.Text;
            dep.HRCode = modify_hr_code.Text;
            if(!string.Empty.Equals(modify_display_id.Text))
            {
                dep.DisplayId = Convert.ToInt32(modify_display_id.Text);
            }
            dep.Remark = modify_remark.Text;
            manager.Update(dep);
            this.AppendWebLog("部门信息修改", "部门编码：" + dep.DepCode);
            this.winModify.Close();
            pageToolBar.DoRefresh();
            //左侧树刷新
            treeDept.GetNodeById(hidden_parent_num.Text).Reload();
            msg.Alert("操作", "更新成功");
            msg.Show();
        }
        catch (Exception ex)
        {
            msg.Alert("操作", "更新失败：" + ex);
            msg.Show();
        }
    }
    #endregion

    #region 校验方法
    /// <summary>
    /// 检查用户名是否重复
    /// yuany
    /// 2013年1月31日
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void CheckDeptName(object sender, RemoteValidationEventArgs e)
    {
        TextField field = (TextField)sender;
        string deptname = field.Text;
        EntityArrayList<BasDept> deptList = manager.GetListByWhere(BasDept._.DepName == deptname);
        if (deptList.Count == 0)
        {
            e.Success = true;
        }
        else
        {
            if (deptList[0].DepName.ToString() == hidden_dept_name.Value.ToString())
            {

                e.Success = true;
            }
            else
            {
                e.Success = false;
                e.ErrorMessage = "此部门名称已被使用！";
            }
        }
    }

    protected void CheckFieldInt(object sender, RemoteValidationEventArgs e)
    {
        TextField field = (TextField)sender;
        Regex regex = new Regex(@"^[\d]+$");
        if (regex.IsMatch(field.Text) || field.Text == "")
        {
            e.Success = true;
        }
        else
        {
            e.Success = false;
            e.ErrorMessage = "此填入项必须为正整数!";
        }
    }
    #endregion
}